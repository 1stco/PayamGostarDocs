# ایجاد کاربر جدید از طریق اکسل

در صورت نیاز به ایجاد تعداد زیادی کاربر به صورت یکجا می‌توانید از روش ورود اکسلی استفاده نمایید. بدین ترتیب می‌توانید اطلاعات کاربران مورد نظر را در اکسل درج نمایید و سپس بارگذاری کنید. در این حالت کاربران مورد نظر ایجاد شده و اطلاعات آن در فیلدهای مربوطه وارد می‌شود. این روش در ویرایش اطلاعات مربوط به کاربران می‌تواند بسیار کارآمد باشد به عنوان مثال برای ویرایش پورسانت کاربران می‌توانید از ورود اطلاعات از طریق اکسل برای اعمال تغییرات جدید کمک بگیرید.<br>
برای اینکه بارگذاری کاربران بدون مواجهه با خطا و با موفقیت به اتمام برسد، لازم است که قوانین تهیه و بارگذاری اکسل را رعایت کنید. در این راهنما تمامی موارد لازم برای تنظیم صحیح فایل اکسل، به همراه شیوه بارگذاری آن مطرح شده‌است. بدین منظور در این مقاله به موارد زیر می‌پردازیم:<br>
- [تنظیمات فایل اکسل](#UsersExcelSetting)
- [روش بارگذاری فایل اکسل کاربران](#UsersExcelUploading)
- [مجوزهای لازم برای بارگذاری اکسل کاربران](#UsersExcelPermision)

## تنظیمات فایل اکسل{#UsersExcelSetting}
برای ورود اطلاعات کاربران از طریق اکسل، ابتدا باید اکسل مورد نظر را بر اساس فرمت مورد پذیرش نرم‌افزار تنظیم کنید. بدین منظور می‌توانید اکسلی با ستون‌هایی که در تصویر می‌بینید ایجاد کنید و یا از فایل نمونه استفاده نمایید. 
برای اینکه بتوانید کاربران را به همراه حکم پرسنلی‌شان در نرم‌افزار بارگذاری کنید، به اکسلی نیاز دارید که تمامی فیلدهای اطلاعاتی کاربر را در کنار فیلدهای اطلاعاتی حکم‌های پرسنلی داشته‌باشد. در تهیه‌ی اکسل مذکور، از راهنمای زیر استفاده کنید تا یک فایل کامل و مناسب برای بارگذاری در پیام‌گستر داشته‌باشید:
فایل نمونه در مرحله‌ی اول بارگذاری به شما ارائه می‌شود (جلوتر به آن می‌رسیم).<br>

![تکمیل فایل اکسل نمونه کاربران](./Images/users-excel-sample_2.8.4.png)

تصویر فوق،‌ ستون‌های مورد نیاز برای بارگذاری کاربر را بر اساس فیلدهای پیش‌فرض کاربر نشان می‌دهد. در صورت افزودن فیلدهای اضافه (در شخصی‌سازی)، برای هر فیلد یک ستون با نام مشابه آن ایجاد نمایید. چنانچه از فایل نمونه‌ای که نرم‌افزار به شما می‌دهد استفاده می‌کنید، این فیلدها به صورت خودکار در فایل اکسل قرار داده‌می‌شود.<br>
برای تکمیل اطلاعات مربوط به فیلدهای پیش‌فرض به راهنمایی‌های زیر توجه داشته باشید:
- **نوع کاربری**:  برای نوع کاربری، «اپراتور» را درج کنید.
- **نوع هویت**: منظور از نوع هویت حقیقی یا حقوقی بودن آن است. در نتیجه برای کاربر، عبارت «حقیقی» را در ستون هویت درج کنید.
- **زیرنوع هویت**: برای تعیین زیرنوع هویت لازم است که «کلید زیرنوع موجودیت» مورد نظر را وارد کنید. برای پیدا کردن کلید زیرنوع هویت، از مسیر **تنظیمات** > **شخصی‌سازی CRM** > **نمای کلی** وارد صفحه مدیریت موجودیت‌های  CRM و  قسمت هویت شوید سپس از بین زیرنوع‌های موجودیت هویت، مخاطب حقیقی (کاربر) را پیدا کنید. با کلیک بر روی می‌توانید وارد صفحه ویرایش آن شوید و در بخش «کد»، کلید آن را پیدا کنید.
- **نام**: نام شخص را به صورت فارسی وارد نمایید.	
- **نام‌خانوادگی**: نام‌خانوادگی شخص را به صورت فارسی وارد نمایید.
- **ایمیل**:آدرس ایمیل کاربر را وارد کنید. 
- **موبایل**: شماره موبایل کاربر را وارد کنید.

> **نکته**<br>
> توجه داشته‌باشید که برای تعریف موبایل، از ۹۸+ به جای صفر ابتدای شماره استفاده کنید.

- **نام کاربری**: نام کاربری مورد نظر را تعریف کنید. برای ثبت نام‌کاربری باید قوانین مشخصی را رعایت کنید که عبارتند ار: نام کاربری باید به زبان انگلیسی و بیشتر از ۵ کاراکتر باشد تا هنگام بارگذاری با مشکل مواجه نشوید. بهترین الگو برای نام کاربری، ابتدای نام در کنار نام خانوادگی به انگلیسی است که با نقطه از هم جدا شده‌اند. به عنوان مثال در فایل نمونه برای کاربر «مهسا صالحی» نام‌کاربری «m.salehi»  را درنظر گرفته‌شد.
- **کلید کاربری**: کلید کاربری ترکیبی از حروف انگلیسی و عدد است که می‌بایست به منحصر به‌فرد بودن آن توجه لازم را داشته‌باشید.
- **رمز عبور**: برای کاربر موردنظر رمز عبور تعریف کنید. توجه داشته‌باشید که در صورت تنظیم سیستم برای الزام تعیین رمزپیچیده یا حداقل تعداد کاراکتر، الزامات لازم را در درج رمز عبورها رعایت کرده‌باشید. با توجه به اینکه کاربران پس از ورود به حساب کاربری خود ملزوم به تغییر رمز هستند پیشنهاد می‌شود که همه‌ی رمزها را ۱۲۳۴۵۶۷۸ تعریف نمایید.
- **رمز تلفنی**: برای کاربر موردنظر رمز تلفنی تعریف کنید. 
- **فعال**:فعال بودن حساب کاربری را با درج «بلی» در ستون فعال، مشخص کنید. 
- **عدم فعال‌سازی**:  با درج «بلی» در ستون عدم فعال‌سازی این گزینه را فعال کنید به همین ترتیب اگر قصد منقضی نشدن رمز عبور را دارید.
- **مدت زمان عبور**:مدت زمان عبور این گزینه را فعال کنید
- **درصد پورسانت**: در صورت نیاز، درصد پورسانت کاربر را به عدد و بدون درج علامت ٪ در ستون درصد پورسانت وارد کنید.

برای ورود کاربر، اطلاعات فوق کافی بوده و با آن‌ها می‌توانید کاربران مورد نظر را ایجاد کنید. برای اینکه حکم پرسنلی هر کاربر نیز همزمان با ایجاد کاربر در سیستم ایجاد شود، اکسل خود را بر اساس راهنمای زیر تکمیل کنید.

- **تاریخ شروع حکم**: تاریخ شروع را مشخص کنید. توجه داشته‌باشید که این ستون را با فرمت تاریخ شمسی (روز/ماه/سال) ثبت نمایید.
- **تاریخ پایان حکم**:تاریخ پایان حکم را مشخص کنید. توجه داشته‌باشید که این ستون را با فرمت تاریخ شمسی (روز/ماه/سال) ثبت نمایید.
- **شعبه** : توجه داشته‌باشید که در ستون شعبه، «کد» شعبه مورد نظر را درج کنید. برای به دست آوردن کد شعبه از مسیر **اطلاعات پایه** >**مدیریت شعب، دپارتمان و سمت** وارد صفحه چارت سازمانی شوید و شعبه مورد نظر را انتخاب کنید. با کلیک راست بر روی شعبه و انتخاب گزینه‌ی ویرایش وارد صفحه ویرایش شعبه شوید و کلید شعبه را از بخش اطلاعات پیدا کنید. در صورت عدم وجود کلید، با استفاده از حروف انگلیسی و عدد، یک کد برای آن تعریف و ذخیره کنید.
- **دپارتمان**:نام دپارتمان را با عنوان فارسی آن‌ها در ستون‌ بعدی وارد کنید. توجه داشته‌باشید که عبارت مندرج در اکسل (به عنوان نام دپارتمان) دقیقاً باید منطبق بر اسامی تعریف شده در چارت باشد. به همین منظور از روی چارت سازمانی‌ای که در صفحه مقابل خود دارید برای درج صحیح و کامل اسامی استفاده کنید.
- **سمت**: نام  سمت را با عنوان فارسی آن‌ها در ستون‌ بعدی بعدی وارد کنید. برای تعیین سمت، لازم است که ابتدا شعبه و سپس به ترتیب دپارتمان و سمت مورد نظر را در سه ستون مجزا درج کنید.

> **نکته**<br>
برای تخصیص حکم پرسنلی، باید فیلدهای «تاریخ شروع»، «تاریخ پایان»، «شعبه»، «دپارتمان» و «سمت» که اجباری هستند را در فایل اکسل مقداردهی کنید.

- **فعال (حکم)**: فعال بودن را با درج «بلی» در ستون‌های فعال (حکم) مشخص کنید.
- **پیش‌فرض (حکم)**: پیش‌فرض بودن حکم را با درج «بلی» در ستون‌ پیش‌فرض مشخص کنید.
-**توضیحات (حکم)**: در صورت نیاز به درج توضیحات در حکم پرسنلی، در ستون توضیحات (حکم) می‌توانید آن را وارد کنید.

> **نکته**<br>
 لازم‌به‌ذکر است در مورد به‌روزرسانی اطلاعات، فیلدهای نام کاربری، نوع هویت، زیرنوع هویت و نوع کاربری قابل ویرایش نیستند. <br>

چنانچه کاربر مورد نظر دارای فیلدهای اضافه (اضافه شده در شخصی‌سازی) می‌باشد، ستونی هم نام با فیلد خود به ستون‌های موجود در اکسل اضافه و اطلاعات مورد نظر را در ستون مربوطه وارد نمایید. در این خصوص به نکات زیر توجه داشته باشید:<br>
- امکان ورود اطلاعات فیلدهایی از نوع فایل، تصویر، html، کمپین، برچسب، لیست مرتبط، فیلد آیتم‌های CRM (مثل فیلد پرداخت،‌فاکتور و... به جز فیلد شخص/شرکت)، فیلد اضافه از نوع رنگ، فیلد لیستی از نوع فایل و فیلد لیستی از نوع کاربر/گروه از طریق اکسل وجود ندارد.
- در صورت استفاده از فیلد چک باکس،‌ با استفاده از «بلی» چک باکس تیک خورده و در صورت ذکر «خیر» چک باکس بدون تیک لحاظ می‌شود. البته از عبارات yes/no و true/false و همچنین اعداد 1/0 نیز می‌توانید بدین منظور استفاده نمایید.
- در صورت استفاده از فیلد کاربر، از بین کاربران تعریف شده در نرم‌افزار نام کاربر و یا کد کاربر مورد نظر را در این قسمت درج نمایید.
- برای ورود اطلاعات به فیلدهایی از نوع لیست کشویی فقط از عبارات موجود در لیست می‌توانید استفاده نمایید. فیلدهای لیست کشویی پیش‌فرض نرم‌افزار در بخش مدیریت آیتم‌های سیستم و لیست‌های کشویی اضافه‌ شده توسط شما در بخش شخصی‌سازی آن آیتم قابل مشاهده و ویرایش می‌باشند. چنانچه برای یک فیلد لیست کشویی، دو گزینه با عنوان مشابه تعریف شده باشد، ورود اطلاعات (مقداردهی) آن از طریق اکسل با خطا مواجه می‌شود.

## مراحل بارگذاری فایل اکسل{#UsersExcelUploading}
برای بارگذاری فایل اکسل کاربران به این ترتیب اقدام نمایید:
### بارگذاری فایل
برای بارگذاری فایل اکسل از مسیر تب **تنظیمات** > **مدیریت گروه‌ها و کاربران**  وارد صفحه لیست کاربران شوید. بر روی کلید «ورود اطلاعات از اکسل» کلیک کنید تا صفحه بارگذاری به شما نمایش داده‌شود.<br>

![بارگذاری اکسل فرم‌ها](./Images/user-excel-upload_2.8.4.png)

با کلیک بر روی کلید فایل نمونه (شماره ۱) می‌توانید قالب نمونه اکسل را فرم‌ نمایید. همان طور که پیش‌تر به آن اشاره شد، در این قالب به دلیل اینکه قصد دارید هویت‌های ار نوع کاربر را وارد نرم‌افزار کنید تنها عبارتند کاربر به شما نشان داده‌می‌شود. 
پس از تنظیم فایل اکسل، با کلیک بر روی کلید بارگذاری فایل (شماره ۲)، فایل مورد نظر را انتخاب و بارگذاری کنید. پس از اتمام بارگذاری، کلید مرحله‌ی بعد (شماره ۳) در پایین صفحه برای شما فعال می‌شود. با کلیک بر روی این کلید، برای اعمال تنظیمات به مرحله‌ی بعدی می‌روید.<br>

### تنظیمات بارگذاری فایل
در این بخش باید تنظیمات لازم جهت تعیین روش ورود اطلاعات را مشخص کنید.

![تنظیمات بارگذاری فایل](./Images/user-excel-setting_2.8.4.png)

**1. افزودن اطلاعات جدید**<br>
با انتخاب این گزینه، تمامی کاربران جدید موجود در اکسل بر اساس مبنای انتخابی شما شناسایی و بارگذاری می‌شود. در این مرحله می‌توانید فیلد «کلید کاربری» یا «نام کاربری» را به عنوان مبنای شناسایی انتخاب کنید. براساس فیلد مبنا جستجوی تکراری بودن انجام شده و در صورت تکراری نبودن کاربر (یعنی اگر کاربری با این نام کاربری در سیستم وجود نداشته‌باشد)، آن کاربر به لیست کاربران اضافه می‌شود.<br>
**2. ‌ویرایش اطلاعات موجود**<br>
در این حالت براساس فیلدی که به عنوان مبنا انتخاب شده‌است (نام‌کاربری)، جستجو انجام‌می‌شود. در صورت وجود کاربری با نام‌کاربری مشابه، کاربر مربوطه ویرایش شده و اطلاعات موجود در اکسل برای آن درج می‌شود. در صورت یافت نشدن فرم با چنین نام‌کاربری اطلاعات آن سطر از اکسل بارگذاری نخواهدشد<br>.
با انتخاب چک باکس " فقط فیلد‌های خالی پر شوند" تنها فیلدهای خالی هویت مقداردهی شده و فیلدهایی که دارای اطلاعات می‌باشند بدون تغییر باقی می‌مانند.<br>

**3. افزودن و ویرایش**<br>
در این حالت بر اساس فیلد مبنای انتخاب شده جستجو انجام می‌شود. در صورت وجود کاربری با اطلاعات فیلد مبنا، کاربر مربوطه ویرایش می‌شود و در صورت یافت نشدن کاربر با نام‌کاربری یا کد کاربری یکسان (فیلد مبنا)، آن رکورد به عنوان کاربر جدید به نرم‌افزار اضافه می‌شود.<br>
با انتخاب چک باکس "فقط فیلد‌های خالی پر شوند"،‌ اطلاعات کاربرانی که بر اساس فیلد مبنا یافت شده و نیازمند ویرایش می‌باشند، ‌تنها فیلدهای خالی مقداردهی شده و فیلدهایی که دارای اطلاعات می‌باشند بدون تغییر باقی می‌مانند.<br>

>**نکته**<br>
در حالت ویرایش (حالت ۲ و ۳)، چنانچه بر اساس مبنای جستجو، چند کاربر با اطلاعات مورد نظر یافت شود، (مثلا در حالتی که مبنا کلیدکاربری است،‌ چند کاربر دارای یک کلید یکسان باشند) ویرایش بر روی هیچ یک از کاربران انجام نمی‌گیرد.<br>

به این موضوع توجه داشته‌باشید که در زمان ویرایش، مقادیر مندرج در اکسل جایگزین مقادیر قبلی می‌شوند. بنابراین در صورتی که نیاز است مقادیر جدید بدون حذف مقادیر قبلی به آن‌ها اضافه شوند، باید مقادیر قبلی موجود هر فیلد که قصد حفظ آن را دارید، در اکسل تکرار شوند.<br>
برای ادامه‌ی فرآیند بارگذاری، بر روی کلید مرحله بعدی کلیک کنید.<br>

### نگاشت فیلدها
در مرحله سوم، سرستون‌های فایل اکسل در بخش «فیلدهای فایل شما» (شماره ۱) و فیلدهای موجود در مشخصات کاربر در بخش «فیلدهای ماشین شما» (شماره ۲) نمایش داده‌می‌شود. در واقع در این بخش مشخص می‌شود که اطلاعات هر ستون اکسل باید در کدام فیلد فرم‌ وارد شود.<br>
در صورت یکسان بودن نام ستون با نام فیلد مربوطه،‌ نگاشت به صورت خودکار انجام می‌گیرد. در غیر این صورت باید با drag & drop نام هر ستون را از بخش فیلدهای فایل شما (سمت راست) به فیلد مربوطه در بخش فیلدهای ماشین شما (سمت چپ) متصل نمایید. در این شرایط برای یافتن عنوان مورد نظر در هر دو بخش می‌توانید از قابلیت جستجو (شماره ۳)‌ استفاده کنید.<br>

![نگاشت فیلد فرم‌‌ها](./Images/user-excel-mapping_2.8.4.png)

اگر نگاشت خود را به صورت دستی انجام داده‌اید، می‌توانید نگاشت خود را ذخیره نمایید (شماره ۴). در صورت استفاده مجدد از این اکسل یااکسل مشابه برای بارگذاری، با کلیک بر روی نگاشت‌های من (شماره ۵)، نگاشت به صورت خودکار انجام می‌شود. شما می‌توانید نگاشت‌های پرکاربرد خود را در سیستم ذخیره نموده و در وقت خود صرفه‌جویی کنید. در لیست نگاشت‌های من امکان ویرایش یا حذف نگاشت ذخیره شده نیز وجود دارد.<br>
شما این امکان را دارید که برای هر فیلد مقداری را به عنوان مقدار پیش‌فرض (شماره ۶) در نظر بگیرید تا در صورت خالی بودن مقدار فیلد در اکسل، فیلد با مقدار پیش‌فرض که در این قسمت تعریف کرده‌اید پر می‌شود.<br>
برای شروع بارگذاری، روی کلید مرحله بعدی کلیک کنید. <br>

### شروع بارگذاری
بارگذاری فایل ممکن است لحظاتی زمان ببرد. پس از اتمام فرآیند بارگذاری، در صورت بارگذاری موفق اکسل،‌ انجام موفقیت‌آمیز آن در این صفحه اعلام می‌شود.اگر ورود اطلاعات بدون خطا و با موفقیت انجام شده‌باشد، برای هر ردیف اکسل، یک کاربر و یک حکم پرسنلی در پیام‌گستر ایجاد می‌شود. پیشنهاد می‌شود که پس از آن به صفحه‌ی لیست گروه‌ها و کاربران بروید و نتیجه را بررسی کنید. افزوده شدن کاربران جدید را با مقایسه تعداد کاربران با سطرهای اکسل و ویرایش کاربران را با بررسی چند نمونه‌ی تصادفی می‌توانید به راحتی چک کنید.<br>
چنانچه بارگذاری فایل با خطا مواجه شده‌باشد، پیغامی مشابه تصویر زیر به شما نمایش داده‌می‌شود.<br>

![ارور فایل اکسل](./Images/user-excel-upload-result_2.8.4.png)

در منوی گزارش‌ها، بخش وضعیت عملیات انبوه می‌توانید نتایج ورود اطلاعات را مشاهده کنید. در صورت بروز خطا در فرآیند بارگذاری، با دانلود فایل اکسل از این بخش می‌توانید خطا و علت خطا را مشاهده نمایید. برای دانلود فایل، بر روی جزئیات رکورد مربوطه کلیک کرده و خروجی اکسل را دریافت کنید. در اکسل دریافتی، سطرهای دارای مشکل با رنگ قرمز مشخص شده و در ستون آخر دلیل بروز خطا درج شده‌است.<br>

## مجوزهای مورد نیاز برای بارگذاری کاربر از طریق اکسل{#UsersExcelPermision}
برای ثبت فرم‌ از طریق اکسل،‌ کاربر باید دارای مجوزهای زیر باشد:
- **برای افزودن اطلاعات جدید**<br>
برای افزودن اطلاعات  کاربر (مورد ۱ در تنظیمات بارگذاری فایل) باید مجوز **ذخیره اولیه**  را داشته‌باشید.
- **برای ویرایش اطلاعات موجود**<br>
برای ویرایش اطلاعات کاربر (مورد ۲ در تنظیمات بارگذاری فایل) باید مجوز **ویرایش**  را داشته‌باشید.
- **برای افزودن و ویرایش**<br>
برای افزودن و ویرایش اطلاعات (مورد ۳ در تنظیمات بارگذاری فایل) باید مجوز **ذخیره اولیه** و همچنین مجوز **ویرایش**  را داشته‌باشید.

> **نکته**<br>
تعداد کاربران فعال در سیستم، با توجه به نوع بسته خریداری شده متفاوت خواهدبود.
 ورود کاربران از طریق اکسل نیازمند مجوز **مدیر گروه و کاربران** بوده، همپنین در صورت تخصیص حکم پرسنلی نیاز به مجوز **مدیریت حکم‌ها** یا **مدیر سیستم** خواهید‌داشت.


در این بخش با نحوه‌ی ایجاد کاربر و حکم‌های پرسنلی به صورت یکجا آشنا شدید. از همین روش برای ایجاد کاربر (بدون حکم پرسنلی) نیز می‌توانید استفاده کنید. فقط کافیست که ستون‌های مرتبط با حکم پرسنلی را از اکسل خود حذف کنید.