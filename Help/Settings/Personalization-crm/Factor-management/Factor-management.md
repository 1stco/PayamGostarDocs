# تنظیمات اختصاصی فاکتورها 

از این قسمت می‌توانید تنظیمات مرتبط با پیش فاکتورها، فاکتورها و فاکتورهای برگشتی را مشخص نمایید.

لطفا ابتدا [تنظیمات مشترک آیتم‌های سیستم]( https://github.com/1stco/PayamGostarDocs/blob/master/help2.5.4/Settings/Personalization-crm/Overview/General-information/Shared-information-of-system-items/Shared-information-of-system-items.md) و آیتم‌های حقوقی/مالی را در این خصوص مطالعه فرمایید.


 **فروش:** پیش فاکتور، فاکتور فروش و فاکتور برگشت از فروش مرتبط با بحث فروش کالا و خدمات هستند.

 **پیش فاکتور:** این نوع فقط برای اعلام قیمت است و مبلغ کل آن به عنوان بدهی برای مخاطب حساب نشده و کالایی را نیز از انبار خارج نمیکند.(اما تعداد کالای درج شده در پیش فاکتور فروش به عنوان موجودی فریز شده محسوب خواهد شد)

 **فاکتور فروش:** بعد از ذخیره این نوع برای یک مخاطب و تایید آن، به مبلغ این فاکتور مخاطب در نرم افزار بدهکار می‌گردد. (در صورت فعال نبودن ماژول انبارداری پیشرفته، کالاهای لحاظ شده در فاکتور از موجودی انبار محصولات کسر می‌گردد در غیر این صورت باید برای خروج کالا حواله خروج صادر گردد.)

 **فاکتور برگشت از فروش:** پس از برگشت یک فاکتور فروش، با صدور این نوع فاکتور برای آن، به مقدار مبلغ کل کالاهایی که در این فاکتور برگشت داده میشوند، مشتری بستانکار حساب خواهد شد و تعداد کالاهای مرجوعی (نکته: در صورت وجود ماژول انبار داری پیشرفته باید برای برگشت کالاها رسید مرجوعی صادر کرد) به انبار اضافه می‌گردد. (امکان صدور فاکتور برگشت تنها برای فاکتورهای تایید شده امکان پذیر است.)

 **خرید:** پیش فاکتور خرید، فاکتور خرید و فاکتور برگشت از خرید مرتبط با بحث خرید کالا و خدمات هستند.

 **پیش فاکتور خرید:** این نوع فقط برای استعلام قیمت است و مبلغ کل آن به عنوان بستانکاری برای مخاطب محاسبه نشده و کالایی را نیز به انبار وارد نمیکند.

 **فاکتور خرید:** بعد از ذخیره این نوع برای یک مخاطب، به مبلغ این فاکتور مخاطب در نرم افزار بستانکار می‌گردد. (در صورت فعال نبودن ماژول انبارداری پیشرفته، کالاهای لحاظ شده در فاکتور به موجودی انبار محصولات اضافه می‌گردد، در غیر این صورت باید برای ورود کالا رسید انبار صادر گردد.)

 **فاکتور برگشت از خرید:** پس از برگشت یک فاکتور خرید، با صدور این نوع فاکتور برای آن، به مبلغ کل کالاهایی که در این فاکتور برگشت داده میشوند، مشتری بدهکار حساب خواهد شد و تعداد کالاهای مرجوعی نیز از انبار خارج می‌گردد. (امکان صدور فاکتور برگشت تنها برای فاکتورهای تایید شده امکان پذیر است.)

![](FactorsManagement1.png)

به طور پیش فرض، یک فاکتور، پیش فاکتور و فاکتور برگشتی در سیستم با قالب پیش فرض قرار داده شده است. که می‌توان تغییرات لازم را بر روی فیلدها و قالب نمایشی آن اعمال کرد. همچنین با انتخاب آیکون + هم می‌توانید انواع جدیدی را برای سیستم طراحی نمایید.

### تنظیم فاکتور

علاوه بر تنظیمات عمومی، تنظیمات اختصاصی فاکتورها به شرح زیر می‌باشد. (عکس زیر از تنظیمات یک پیش فاکتور فروش درج شده است)

![](FAKTORHA.png)

**1. نام:** مي توانيد نام فاکتور را به دلخواه خود تعيين کنيد.

**2. توضیحات:** توضیحات مرتبط با فاکتور را مشخص کنید.

**3. ترتیب نمایش:** با این امکان، میتوانید لیست آیتم‌ها را براساس فیلد مورد نظر خود مرتب‌سازی کنید.
فیلدهایی که امکان مرتب سازی آیتم‌ها براساس آن‌ها وجود دارد تنها فیلد‌های اضافه شده ی از نوع عدد ،شناسه خودکار،تاریخ شمسی و تاریخ میلادی که دارای الزام می‌باشند که 
 به موجودیت‌های اصلی و زیر نوع موجودیت‌ها افزوده گردیده است.
 
>  نکته:  اگر مقادیر فیلد انتخاب شده برای مرتب سازی، در بین آیتم‌ها یکسان باشد، حالت نمایش این آیتم‌ها در لیست، براساس تاریخ ایجاد و به صورت نزولی خواهد بود . 
برای نمونه فرض کنید به آیتم فرم یک فیلد با عنوان تاریخ مرخصی اضافه کرده ایم و ترتیب نمایش فرم را براساس این فیلد تنظیم کرده ایم.

 اگر فرم‌هایی با یک تاریخ مرخصی یکسان وجود داشته باشند، ترتیب نمایش بین این چند فرم در لیست براساس تاریخ ایجاد و به صورت نزولی میباشد.
 
>  نکته:  قابل ذکر است تنها لیست آیتم‌ها براساس این ترتیب نمایش تعریف شده، مرتب سازی میگردد، و در سایر بخش‌ها مانند بانک یکپارچه و تب سوابق هویت و ... چینش آیتم‌ها به صورت قبل است.


>  نکته:  قابل ذکر است که ترتیب نمایش آیتم‌ها در لیست‌ها بصورت پیش فرض براساس تاریخ ایجاد آیتم و نزولی است

**4. فعال:** با غير فعال کردن فاکتور، اجازه ذخيره آن را از کاربران خواهيد گرفت. به اين معني که کاربران ديگر نمي توانند مورد جديدي از این نوع فاکتور را ذخيره کنند.

**5. کد:** مي توانيد کد دلخواه (براي مثال کد ايزو (ISO) سازماني) را در اين قسمت وارد کنيد. اين کد فقط شامل اعداد و حروف مي تواند باشد.

**6. مالک:** به قسمت [مالک آیتم]( https://github.com/1stco/PayamGostarDocs/blob/master/help2.5.4/Settings/Personalization-crm/Overview/General-information/Item-owner/Item-owner.md) مراجعه کنيد.

**7. نوع هویت مرتبط پیش فرض:** در این قسمت می‌توانید نوع هویت پیش فرض برای ایجاد هویت مرتبط با آیتم را که از روش چابک ایجاد میشود را انتخاب کرد..

**8. اجازه ويرايش تا:** در صورتي که فيلد "اجازه ويرايش تا" را با يک مقدار عددي به ساعت پر نماييد. تنها تا مدت زمان عددي قبل از اين مقدار اجازه ويرايش به ايجاد کننده آيتم داده خواهد شد (اين محدوديت براي کاربراني که اجازه ویرایش آن آيتم را دارند صدق نمی‌کند و مجوز ویرایش بی تاثیر می‌شود). در صورت خالي بودن فيلد، اجازه ويرايش براي کاربر ايجادکننده آيتم آزاد است.

**9. اجازه حذف تا:** در صورتي که فيلد " اجازه حذف تا" را با يک مقدار عددي به ساعت پر نماييد. تنها تا مدت زمان عددي قبل از اين مقدار اجازه حذف به ايجادکننده آيتم داده خواهد شد (اين محدوديت براي کاربراني که اجازه حذف آن آيتم را دارند صدق نمي کند). در صورت خالي بودن فيلد، اجازه حذف براي کاربر ايجادکننده آيتم آزاد است .

**10. محدود کردن ويرايش به کاربران چرخه کاري:** زماني معني پيدا مي کند که بر روي اين فرم، فرآيند تعريف و فعال شده باشد و در غير اين صورت تاثيري نخواهد داشت. در صورت فعال شدن گزينه، تنها کاربراني مي توانند اين

 فرم را ويرايش کنند که در فرآيند يا چرخه کاري نقش داشته باشد. ( فقط کاربری که مسئول کارتابل است می‌تواند آیتم را ویرایش کند،اگر مسئول یکی از مراحل دیگر باشد هم اماکن ویرایش ندارد، بافعال کردن این گرسنه حتی اگر کاربر ایجاد کننده باشد و یا مجوز ویرایش هم داشته باشد ، نمی‌تواند آیتم را ویرایش کند )

**11. محدود کردن مشاهده به کاربر ايجاد کننده/ مسئول:**  با فعال کردن اين گزينه تنها کاربر ايجاد کننده و يا مسئول آيتم (مثلا در فرصت کاربري که در فيلد "تخصيص داده شده يه" وارد مي شود به عنوان مسئول فرصت شناخته
 مي شود) مي توانند آيتم را مشاهده کنند
 
 **12. نوع پيش نمايش:** مي توان فرمت پيش نمايش مرتبط با اين آيتم را به صورت وورد (قابل ويرايش پس از پيش نمايش گرفتن) يا تصویر یا PDF تنظيم کرد.

**13. الگوی شماره گذاری:** الگوی فاکتور را از بین الگوهایی که قبلا ساخته شده اند انتخاب کنید یا الگوی جدیدی به آن اختصاص دهید.( [نحوه شماره گذاری]( https://github.com/1stco/PayamGostarDocs/blob/master/help2.5.4/Settings/Numbering-template/Numbering-template.md) )

**14. نیاز به تایید دارد:** در صورتی که در روال کاری شرکت شما، آیتم مربوطه پس از ثبت شدن توسط کارشناسان باید به تایید شخص دیگری برسد (با ورود به کارتابل مربوطه)،می‌توانید از این گزینه استفاده کنید. با انتخاب این


 گزینه، پیش نمایش آیتم مربوطه تا زمان تایید شدن امضا نخواهد داشت و در محاسبات مالی نرم افزار لحاظ نخواهد شد (مشتری را بدهکار/بستانکار نخواهد کرد). در صورت غیر فعال بودن این گزینه، این آیتم به محض ثبت تایید خواهد شد.

**15. نیاز به شماره گذاری دارد:**  در صورتی که می‌خواهید آیتم مربوطه پس از ثبت شدن توسط کارشناسان برای شماره گذاری وارد کارتابل کاربرانی که مجوز شماره گذاری آن را دارند گردد،می‌توانید از این گزینه استفاده کنید . در صورت غیر فعال بودن این گزینه، این آیتم به محض ثبت، شماره گذاری خواهد شد.

**16. تخصیص شماره مشتری در هنگام تایید:** در صورت فعال بودن این گزینه، در صورتی که هویت مرتبط با آیتم شماره مشتری نداشته باشد، به محض تایید شدنآیتم مربوطه سیستم به صورت خودکار به این هویت، شماره مشتری اختصاص خواهد داد. (به طور مثال اگر می‌خواهید مخاطبان شما، پس از تایید شدن اولین فاکتور فروش صادر شده برای آن‌ها، شماره مشتری دریافت کنند، می‌توانید در تنظیمات فاکتور فروش این گزینه را فعال کنید)

**17. تغییر وضعیت به "در انتظار تایید و شماره گذاری" پس از ویرایش:** با فعال کردن این گزینه، اگر این آیتم پس از تایید، توسط کاربری که دارای مجوز "ویرایش پس از تایید" باشد ویرایش شود، دوباره به حالت در انتظار برمی‌گردد و باید توسط یکی از کاربرانی که مجوز مربوطه را دارد، تایید و شماره گذاری شود.

**18. مجموع فاکتور عوارض/مالیات/تخفیف قابل ویرایش باشد:** با فعال کردن اين گزينه، هنگام صادر کردن اين نوع از فاکتور مي توان مجموع عوارض/ماليات/تخفیف کالا‌ها را ويرايش کرد

**19. نمایش مبالغ فاکتور به صورت صحیح:**  با فعال کردن این گزینه تمامی‌مبالغ فاکتور به صورت صحیح نمایش داده می‌شوند.

>  نکته:
> صدور حواله/رسید انبار خودکار: در صورتی که از انبارداری سریالی استفاده می‌کنید، در ویرایش فاکتور‌ها تنظیماتی اضافه میگردد که می‌توانید، تنظیماتی اعمال کنید که به صورت خودکار پس از تایید شدن یک فاکتور خرید، رسید انبار مرتبط با آن نیز صادر شود و پس از تایید شدن یک فاکتور فروش، حواله انبار مرتبط با آن نیز برای خروج کالا از انبار صادر گردد. به همین دلیل در تنظیمات فاکتور خرید و فاکتور فروش این موارد را مشاهده می‌کنید، در صورت فعال نمودن صدور تراکنش انبار خودکار، باید نوع تراکنش را نیز مشخص نمایید. در هنگام صدور هر فاکتور نیز باید مشخص کنید که محصولات از کدام انبار خارج شوند (یا اینکه به کدام انبار اضافه گردند)

![](FactorsManagement10.png)


> نکته: توجه داشته باشید در لیست نوع رسید انبار خودکار، رسیدهای از نوع معمولی و در لیست نوع حواله انبار خودکار، حواله‌های از نوع فروش نمایش داده می‌شوند و قابل انتخاب هستند. برای آشنایی با انواع تراکنش‌های انبار به قسمت انبار‌ها مراجعه کنید.

![](FactorsManagement11.png)

**20. مالیات/ عوارض:** درصد مالیات/عوارض را برای این نوع از فاکتور بر حسب درصد می‌توانید تعیین کنید.

**21. تعداد رقم اعشار مقدار:** تعداد رقم اعشاری که برای مقدار محصول نمایش داده می‌شود را می‌توان تعیین کرد. مثلا در صورتی که محصولات بر اساس وزن فروخته می‌شوند می‌توانید با استفاده از سه رقم اعشار، میزان گرم محصول فروخته شده را نیز مشخص کنید

**22. قابلیت اضافه کردن محصول تکراری:** در صورت فعال بودن این گزینه، می‌توان یک محصول را با چند قیمت مختلف در فاکتور وارد کرد. در غیر اینصورت با اضافه کردن محصول تکراری، مقدار آن به ردیف موجود در فاکتور اضافه می‌گردد.

>  نکته: برای افزودن محصول تکراری در پیش فاکتور/فاکتور نام محصول نیز بایستی ابتدا ویرایش شود و سپس با دکمه افزودن، آن محصول در ردیف فاکتور جداگانه ای درج میگردد.

**23. اضافات:** در صورت نیاز می‌توانید یک مبلغ اضافات به فاکتور‌های خود اضافه نمایید، این هزینه می‌تواند هزینه بسته بندی، ارسال یا ... باشد. در صورت فعال نمودن اضافات برای فاکتور، باید نحوه محاسبه آن که می‌تواند مبلغ ثابت (قابل تغییر در هنگام صدور فاکتور) و یا درصدی از مبلغ فاکتور (مبلغ نهایی، مبلغ قبل از تخفیف یا مبلغ قبل از مالیات/عوارض) باشد را مشخص نمایید.

همچنین امکان اعمال مالیات و عوارض بر روی اضافات وجود دارد

که با فعال کردن چک باکس اضافات مشمول مالیات شود از این بخش، مبلغ مالیات تعلق گرفته به اضافات محاسبه و در محاسبات مبالغ فاکتور این مبلغ لحاظ میگردد همچنین با فعال کردن چک باکس اضافات مشمول عوارض گردد، مبلغ عوارض تعلق گرفته به اضافات در محاسبات فاکتور محاسبه و اعمال میگردد.

> نکته: لازم به ذکر است در صورت اینکه نوع اضافات از نوع درصد انتخاب شود و نحوه محاسبه اضافات روی گزینه مبلغ نهایی قرار گیرد امکان اعمال مالیات و عوارض بر روی اضافات وجود ندارد.

**24. فیلدهای ردیف‌های فاکتور:** با استفاده از این گزینه می‌توانید به ردیف‌های فاکتور فیلد‌هایی از نوع عدد و یا متن یا عبارت دلخواه را اضافه کنید و از آن در فرمول محاسبه تعداد و یا فرمول محاسبه قیمت کل استفاده کنید.

**25. افزودن:** در این قسمت فیلدهای ردیف فاکتور از نوع عدد یا متن را میتوانید ایجاد کنید.

**26. افزودن عبارت:** عبارت نیز یک فیلد ردیف فاکتور محسوب می‌شود، با این تفاوت که می‌تواند بر اساس فرمولی از فیلدهای ردیف فاکتور محاسبه شود. یعنی می‌توان فیلدی به ردیف فاکتور اضافه کرد که مقدارش با فرمولی براساس فیلد‌های دیگر محاسبه شود .

![](FactorsManagement9.png)

**27. فرمول محاسبه تعداد:** می‌توانید برای تعداد کالاها فرمول دلخواه خود را تنظیم کنید، با استفاده از این گزینه، فیلد تعداد در هنگام صدور این نوع از فاکتور غیر فعال می‌گردد. (برای مثال [طول]*[عرض] برای کالاهایی که بر حسب متر مربع حساب می‌شوند.)

**28. فرمول محاسبه قیمت کل:** می‌توانید فرمول محاسبه قیمت کل برای یک کالا را به دلخواه خود ویرایش کنید. (برای مثال در تصویر بالا تعداد در قیمت واحد و سپس در نرخ روز دلار ضرب می‌شود تا قیمت کل به دست آید.در این مثال می‌توان قیمت واحد را بر اساس دلار وارد کرد و قیمت کل را بر اساس ریال در اختیار داشت)

در این قسمت می‌توان برای اعمال فرمول محاسبه تعداد و قیمت کل، از فایل اکسل استفاده کرد.**29**

بدین منظور، ابتدا باید "چک باکس " روش محاسبه بر اساس اکسل " فعال گردد و گزینه تنظیمات انتخاب شود.
در این بخش می‌بایست فایل اکسلی که شامل فرمول تعریف شده می‌باشد، پیوست گردد.

![](safhefileexcel1.jpg)

###  ورودی‌ها: 

در بخش کد فیلد، فیلدی را که مقدارش به عنوان ورودی به اکسل در نظر گرفته می‌شود، انتخاب می‌کنیم و در قسمت سلول نیز تعیین می‌کنیم مقدار فیلد انتخاب شده باید برای "کدام" یک از سلول‌های اکسل لحاظ شود. لازم به ذکر است در این حالت می‌توان از فیلدهای اضافه ردیف فاکتور به عنوان ورودی استفاده نمود. به علاوه، در محاسبه‌ی قیمت کل، فیلد تعداد و قیمت واحد نیز به عنوان ورودی قابل انتخاب می‌باشند.

###  خروجی: 

سلول اکسلی که در آن فرمول موردنظر تعریف شده است باید انتخاب شود، این خروجی در فیلدی که فرمول نویسی برای آن انجام ‌می‌شود(تعداد یا قیمت کل) نمایش داده می‌شود.

مثال: برای قیمت کل پیش فاکتور فرمول زیر در اکسل تعریف شده است.

![](formolexcel.jpg)

اگر قیمت واحد سلول B1 اکسل و تعداد محصول سلول C1 درنظر گرفته شود و هر دو به عنوان ورودی باشند، طبق فرمول بالا در صورتیکه مقدار قیمت واحد ضرب در تعداد بزرگ تر از 1000 باشد، این مقدار در 0.95 ضرب می‌شود و در خروجی که همان قیمت کل است نمایش داده می‌شود و در غیر این صورت اگر مقدار قیمت واحد ضرب در تعداد کوچیک تر از 1000 باشد همان مقدار قیمت واحد ضرب در تعداد در قیمت کل نمایش داده می‌شود.

**30. بازخوانی فرمول پیش فرض:** فرمول‌های محاسبه تعداد و قیمت کل را به حالت پیش فرض سیستم باز می‌گرداند.




