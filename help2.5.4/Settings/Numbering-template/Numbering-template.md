# تنظیمات الگوی شماره‌گذاری آیتم‌ها

از قالب شماره دهی برای  شماره گذاری هویت‌ها و انواع آیتم‌های مالی مانند فاکتورها، پیش فاکتورها، قرار دادها، دریافت‌ها و پرداخت‌ها استفاده می‌شود. شماره دهی این آیتم‌ها به دو  صورت دستی و سیستمی‌قابل انجام میباشد
 
برای تعریف قالب شماره‌دهی از مسیر تنظیمات، تعریف الگو شماره‌گذاری اقدام نمایید.

## شماره دهی سیستمی

برای تعریف قالب شماره دهی سیستمی، کاربر بایستی مجوز مدیریت شخصی سازی CRM  را داشته باشد.

##  برای شماره دهی به آیتم‌ها به روش زیر عملگردد:
 
###   تعریف قالب شماره دهی مورد نظر

می‌توان از منو تنظیمات بخش قالب شماره دهی با کلیک بر روی دکمه افزودن، الگوی جدیدی برای شماره گذاری تعریف کرد. همچنین از این صفحه امکان ویرایش و حذف قالب‌های تعریف شده وجود دارد و می‌توان الگوی مورد نظر را براساس پارامترهای عنوان و قالب فیلتر کرد.

> **نکته:** در لیست قالب‌های شماره دهی، تنها امکان حذف قالب‌هایی وجود دارد که تا به حال در آیتمی‌برای شماره گذاری استفاده نشده است.

![](Capture.png)

همچنین می‌توان با کلیک روی ویرایش نوع/افزودن زیرنوع  در صفحه شخصی سازی crm، و  کلیک بر روی دکمه + الگوی جدید تعریف کرد و از الگوهای تعریف شده، الگویی را برای شماره دهی این موجودیت انتخاب نمود.

![](70.png)

با کلیک بر روی دکمه افزودن فرم زیر برای تعریف قالب شماره دهی نمایش داده می‌شود.

![](algo1.png)

**A.الگو شماره گذاری:** در این قسمت  امکان تعریف فرمت مورد نظر برای الگو شماره گذاری وجود دارد.

### سه نوع پارامتر سیستمی‌برای استفاده در قالب شماره دهی وجود دارد:

**1**.      پارامتر (AN) برای شماره دهی آیتم‌ها بصورت خودکار میباشد، در صورت استفاده از این پارامتر در الگو شماره گذاری، آیتم‌ها به صورت خودکار براساس مقدار اولیه‌ی تعریف شده به
صورت پی در پی شماره دهی میشوند

> **نکته:** لازم به ذکر است در صورت عدم استفاده از این پارامتر در الگو، تنها فرمت تعریف شده در الگو شماره گذاری به عنوان 
> شماره‌ی آیتم در نظر گرفته می‌شود و مقدار اولیه در شماره
نمایش داده نمیشود و باید آن آیتم را بصورت دستی شماره دهی کرد.

**2**.      پارامتر(MIYY)برای نمایش سال میلادی استفاده میشود.

**3**.      پارامتر (SHYY) برای نمایش سال شمسی در الگوی شماره گذاری استفاده میشود.

علاوه بر پارامتر‌های سیستمی‌امکان استفاده از کاراکتر‌های ثابت و تعریف پارامتر دلخواه در قالب شماره دهی وجود دارد که در ادامه به صورت مفصل توضیح داده خواهد شد.

### برای تعریف الگو شماره گذاری مراحل زیر را طی کنید:

**1**. هر پارامتر سیستمی‌یا پارامترهایی که توسط شما در قالب تعریف میگردد بایستی در داخل آکولاد تعریف گردد.

مثال:

	{*(AN)}

**2**. برای تعریف هر پارامتر در داخل آکولاد بایستی تعداد کاراکتر آن مطابق روش‌های زیر مشخص کرد:


**2.1**.تعریف قالب شماره دهی با تعداد کاراکتر محدود:

 برای این حصول ، پس از آکولاد میتوان با کاراکتر underline  تعداد کاراکتر‌های مجاز  قالب شماره دهی را تعیین کرد.

برای نمونه در صورت استفاده از سه underline ، تعداد 3 کاراکتر برای این قالب در نظر گرفته خواهد شد.

مثال:

	AN)})___}

لازم به ذکر است در این حالت فیلد مقدار اولیه بایستی حداکثر سه کاراکتره تعریف گردد.

 برای نمونه: در صورت تعریف مقدار اولیه 000 برای الگو مثال بالا، شماره آیتم‌ها از 001 الی 999 خواهد بود و پس از شماره 999 آیتم جدید دیگری ذخیره نخواهد شد.

**2.2**.تعریف قالب شماره دهی با تعداد کاراکتر‌های نامحدود:  

با استفاده از کاراکتر *  محدودیتی برای تعداد کاراکتر قالب شماره دهی در نظر گرفته نخواهد شد و  در این صورت شما میتوانید مقدار اولیه را با تعداد کاراکتر دلخواه مقدار دهی کنید.

برای نمونه ، در قالب شماره دهی  زیر با وارد کردن * پیش از (AN) و  تعریف مقدار اولیه 0 برای این قالب،  شماره آیتم‌ها از 1 الی بی نهایت خواهد بود.

	AN)})*}

 

**3**.  برای استفاده از پارامترهای سیستمی‌نام پارامتر بایستی داخل پرانتز مطابق الگوی بالا تعریف گردد.

**4**. در صورت اینکه بخواهید شماره‌ها از کاراکترهای ثابت پیروی کنند،این کاراکتر بایستی در قالب تعریف گردد.

مثال: فرض کنید شما میخواهید از کاراکتر dr- به صورت ثابت در شماره آیتم‌های خود استفاده کنید برای این حصول قالب میتواند به صورت نمونه به شکل زیر تعریف گردد

![](olgo2.png)

در صورت تعریف این الگو با مقدار اولیه 1، شماره اولین آیتم با این الگو به این صورت خواهد بود.

![](olgo3.png)

**5**. در صورت اینکه بخواهید از یک پارامتر دلخواه در قالب شماره دهی استفاده کنید که این پارامتر در شماره قابل ویرایش باشد، بایستی الگوی زیر  را تعریف نمایید.

![](olgo4.png)

با فرض تعریف این الگو برای یک قالب، مقدار پیش فرض A به جای این پارامتر در شماره آیتم‌ها نمایش داده میشود که به صورت دستی قابل ویرایش است .

## برای تعریف الگو شماره گذاری رعایت موارد زیر الزامی‌میباشد:

**1**. از یک نوع پارامتر سیستمی‌نمیتوان به دفعات در یک قالب استفاده کرد.

مثال:  نمیتوان از پارامتر (SHYY) بیش از یکبار در یک قالب استفاده کرد.
**2**. امکان استفاده از چند پارامتر سیستمی‌باهم وجود دارد.

برای نمونه میتوان در یک قالب هم از پارامتر میلادی هم از پارامتر شمسی در یک قالب استفاده کرد.

**3**. لازم به ذکر است در تعریف پارامتر‌های شمسی و میلادی به منظور مشخص نمودن تعداد کاراکترهای آن پارامتر،  بایستی  چهار underline  و یا * در داخل آکولاد قبل از پارامتر قرارگیرد

مثال: 

	{*(MIYY)}

مثال: 

	{(MIYY)____}

**4**. در صورت استفاده از پارامترهای SHYY  و MIYY  در قالب شماره دهی، هنگام شماره دهی دستی آیتم می‌توان از سال 1357 الی یک سال پس از سال جاری، آیتم را شماره گذاری کرد.

**5**.  بین هر دو پارامتر استفاده شده در قالب شماره دهی بایستی از یک کاراکتر برای جدا کردن آنها استفاده کرد. این کاراکتر می‌تواند بصورت دلخواه(به جز کاراکتر . و +) انتخاب شود.

مثال: 

	{(MIYY)____} {*(AN)}/

### ذکر چند نمونه برای تعریف الگوی شماره گذاری:

فرض کنید می‌خواهید آیتم‌های مورد نظرتان بصورت موارد زیر شماره دهی شود، بنابراین به صورت زیر الگو آن تعریف گردد.

شماره:  002

![](olgo5.png)

![](olgo6.png)

![](olgo7.png)

> نکته: در مثال اخر در تعریف الگو شماره گذاری از پارامتر دلخواه با نام H  و با مقدار پیش فرض A  استفاده شده است(که می‌توان هر پارامتری را با نام و مقدار پیش فرض دلخواه تعریف کرد)
هنگام استفاده از این الگو، در شماره آیتم مقدار A بعنوان مقدار پیش فرض نمایش داده می‌شود که بصورت دستی می‌توان این پارامتر را در آیتم ویرایش کرد.

**B. مقدار اولیه:** این مقدار بعنوان مقدار شروع شماره دهی قالب  در الگو در نظر گرفته می‌شود .

> **نکته:** اولین شماره ای که به آیتم اختصاص داده می‌شود یکی پس از مقدار اولیه تعریف شده می‌باشد برای نمونه اگر مقدار اولیه 001 تعریف شود ، اولین شماره ی آیتمی‌که از این الگو استفاده می‌کند 002 خواهد بود .

**C. عنوان:** عنوان قالب را وارد می‌کنیم.

**D**.در صورتی که بخواهیم با تغییر سال ، عدد سال یک واحد افزایش پیدا کند و شماره از ابتدای مقدار اولیه الگو پیروی کند ، باید این چک باکس فعال شود. در غیر این صورت با تغییر سال یک واحد به سال اضافه می‌شود و شماره از ادامه شماره‌های قبلی پیروی می‌کند.

**E. ذخیره کردن:** با کلیک روی دکمه ذخیره کردن ، این الگو در لیست قالب‌ها قرار می‌گیرد. با نگهداشتن ماوس روی آن قالب، می‌توان عنوان قالب را هم مشاهده کرد .

> **نکته:** امکان استفاده از یک قالب برای آیتم‌های مختلف وجود دارد. در صورتی که از یک قالب برای چندین آیتم استفاده شود در زمان شماره دهی به هر آیتم، آخرین شماره قالب مورد نظر به عنوان آخرین شماره اختصاص یافته در نظر گرفته شده و سیستم این شماره را یک واحد افزایش داده و به آیتم اختصاص می‌دهد. لازم به ذکر است که در این روش کلیه شماره‌های یک قالب به آیتم‌های مختلف اختصاص می‌یابند. به این ترتیب در کلیه نمونه‌های یک نوع آیتم، شماره‌ها ممکن است پشت سر هم نباشند. 

برای نمونه:اگر در این بخش یک الگویی تعریف کنیم که قالب شماره دهی آن A_{*(AN)} و مقدار اولیه برای آن 1000 تعریف شده باشد و این الگو در هویت حقوقی و پیش فاکتور پیش فرض استفاده گردد، با فرض اینکه اول یک هویت ایجاد شود و بعد پیش فاکتور پیش فرض، شماره A_1001 به هویت و شماره A_1002 به پیش فاکتور پیش فرض اختصاص می‌یابد.
 
> **نکته:** در صورتی که شماره ای به آیتم اختصاص پیدا کند و آن آیتم حذف گردد، شماره تخصیص یافته شده به آن آیتم  را فقط میتوان به صورت دستی به آیتم دیگری تخصیص داد.

> **نکته:** در صورت انتخاب یک قالب شماره گذاری برای یک نوع موجودیت در بخش شخصی سازی، اگر از آن نوع آیتم ایجاد شده باشد و شماره گرفته باشد، دیگر امکان تغییر قالب شماره گذاری و انتخاب قالب دیگر برای آن آیتم وجود ندارد.

> **نکته:** لازم به ذکر است، الگوی شماره گذاری طبق آیتم‌های ذخیره شده پیش میرود.

> **نکته:** باید در نظر داشت که اگر الگویی به آیتمی‌اختصاص داده شود نمیتوان به آن آیتم به صورت دستی شماره ای خارج ار الگو تخصیص داد.

> **نکته:** لازم به ذکر است فعالیت تبدیل نوع برای آیتم‌های مالی و یا تبدیل هویت ،اگر آیتم و یا هویت شماره داشته باشد، تنها در صورتی تبدیل نوع انجام می‌شود که قالب شماره دهی آیتم مبدا و مقصد یکسان باشد.
 
 **فیلد مقدار نهایی:**  عددی که در این فیلد وارد می‎شود آخرین عدد استفاده شده برای شماره گذاری را نشان می‌دهد. به عنوان مثال اگر عدد اولیه  100 باشد و طبق این الگو آیتمی‌ایجاد شود، شماره 101 به آن اختصاص پیدا می‌کند بنابراین در فیلد مقدار نهایی عدد 101 نمایش داده می‌شود. 
به علاوه با استفاده از این قابلیت می‌توان مقدار نهایی فعلی را نیز ویرایش نمود. تنها توجه داشته باشید که اگر قصد دارید عددی کوچکتر از مقدار نهایی فعلی را وارد کنید، عدد جدید نباید قبلا استفاده شده باشد. به عنوان مثال اگر عدد مقدار نهایی در حال حاضر 150 باشد و  بخواهید به عدد 120 تغییر دهید، 120 نباید قبلا استفاده شده باشد. در نظر داشته باشید در این حالت بعد از ادامه شماره دهی و رسیدن به عدد 150 ارور تکراری بودن داده می‌شود و می‌توان برای رفع این مساله از دو طریق عمل نمود:

**1-** این شماره را به صورت دستی به عدد 151 تغییر دهید.

**2-**مجددا عدد 150 را در بخش الگوی شماره گذاری به عنوان مقدار نهایی تعیین نمایید تا شماره 151 برای آیتم جدید در نظر گرفته شود.

![](meghdarnahayi.png)
 
کاربرد فیلد مقدار نهایی برای وقتی است که شماره گذاری از ترتیب الگوی انتخابی پیروی نمی‌کند. به عنوان مثال شماره گذاری بصورت دستی انجام شده و در واقع فاصله ای بین شماره‌ها بوجود آماده است. برای استفاده از اعدادی که در این فاصله هستند و به عبارتی استفاده نشده‌اند، می‌توان از فیلد مقدار نهایی در الگوی شماره گذاری استفاده کرد.

 
####  ویرایش قالب شماره دهی

در صورت ویرایش قالب شماره دهی، تمامی‌آیتم‌هایی که از این الگو استفاده کرده اند طبق الگوی جدید ویرایش می‌شوند.

برای نمونه:

![](olgo8.png)

![](olgo9.png)

فرض کنید الگوی تعریف شده بصورت زیر ویرایش شود:

![](olgo10.png)

شماره آن آیتم بصورت زیر ویرایش خواهد شد:


![](olgo11.png)

### شماره دهی دستی

#### موارد زیر در مورد وارد کردن شماره دستی باید درنظر گرفته شوند:

**1**. در صورتی که کاربر شماره ای را به صورت دستی وارد کند، تنها در صورتی ذخیره می‌شود که شماره وارد کرده در تمام آیتم‌های دارای این قالب تکراری نباشد.

**2**. در صورتی که آخرین شماره در یک آیتم به صورت دستی وارد شده باشد، شماره دهی‌های بعدی این آیتم، از آخرین شماره ای که کاربر به صورت دستی وارد کرده بوده، ادامه می‌یابد.

> **نکته:** کاربر برای شماره دهی دستی آیتم‌ها نیاز به مجوز شماره گذاری روی آن نوع ایتم را دارد .
