# ورود اطلاعات  مخاطب حقیقی از طریق اکسل
 
می‌توانید اطلاعات هویت‌هایی که در قالب فایل اکسل (Excel) موجود می‌باشند را به راحتی به یکی از دسته بندی‌های  بانک اطلاعاتی اضافه یا اطلاعات هویت‌هایی که قبلا وارد نرم افزار کرده اید را به صورت گروهی به روز رسانی کنید.

برای شروع ابتدا باید اطلاعات هویت‌های حقیقی مورد نظری را که می‌خواهید وارد بانک اطلاعاتی کنید، در یک فایل اکسل طبق فرمتی که در ادامه توضیح داده شده است وارد نمایید.

## فرمت فایل اکسل: ####

در هنگام ساختن فایل باید توجه نمود که نیازی نیست عنوان ستون‌ها حتما همنام با پارامترهای سیستم باشد (برای مثال می‌توان برای ستون "نام" از کلمه "اسم" استفاده کرد) یا ترتیب ستون‌ها به همان شکلی که در هنگام ورود از شما خواسته می‌شود، باشد؛ لیکن به منظور ورود اطلاعات برخی از فیلدها می‌بایست فرمت خاصی رعایت گردد که در ذیل به تفصیل شرح داده خواهد شد: 

**جنسیت:** مقدار جنسیت را با اعداد 1 و 2 می‌توان تعیین کرد (1=مرد؛ 2=زن ).

**شماره تلفن همراه:** باید فرمت سلول‌های تلفن همراه به صورت متن ( تکست) باشند و هر شماره تلفن همراه با عدد صفر شروع شود. برای جدا کردن چند شماره تلفن همراه از علامت نقطه ویرگول ";" استفاده کنید.

**تلفن:** فرمت وارد کردن شماره تلفن به شکل "(داخلی)الی~شماره تلفن-پیش شماره " است. برای جدا کردن چند شماره تلفن همراه از علامت نقطه ویرگول ";" استفاده کنید.

**تاریخ:** فرمت وارد کردن تاریخ به شکل "روز/ماه/سال " باید باشد.

**کشور، استان، شهر:** با توجه به اینکه اطلاعات کشور، استان و شهر یک لیست مرتبط و بر اساس اطلاعات وارد شده در قسمت [مدیریت کشورها، استان‌ها و شهرها ]( https://github.com/1stco/PayamGostarDocs/blob/master/help2.5.4/Basic-Information/Management-of-countries-provinces-and-cities/Management-of-countries-provinces-and-cities.md) می‌باشد، در صورت تمایل به وارد کردن این اطلاعات از طریق فایل اکسل، باید هر سه به طور همزمان وارد شوند.

**آدرس:** تنها امکان اضافه کردن یک آدرس از اکسل وجود دارد.

**لیست کشویی:** برای وارد کردن مقدار فیلدهای لیست کشویی مثل نحوه آشنایی، باید اطلاعاتی که در سلول اکسل وارد می‌کنید دقیقا همانند گزینه‌های تعریف شده در آن لیست کشویی باشد. برای تعریف کردن گزینه‌های لیست کشویی از صفحه [مدیریت آیتم‌های سیستم]( https://github.com/1stco/PayamGostarDocs/blob/master/help2.5.4/Basic-Information/Management-of-system-items/Management-of-system-items.md) اقدام کنید.

### نکات:

•	  هنگام ورود اطلاعات در فایل اکسل بایستی فیلدهای الزامی‌مانند نام خانوادگی، در تمامی‌سطرهای فایل اکسل دارای مقدار باشند.

•	امکان واردکردن اطلاعات از طریق اکسل برای فیلدهای اضافه شده از طریق شخصی سازی  نیز در این بخش وجود دارد.

•	 در هنگام ورود اطلاعات هویت‌های حقوقی از طریق فایل اکسل، تنها مدیر شرکت را می‌توان وارد کرد و امکان وارد کردن پرسنل دیگر وجود ندارد. 

![](haghighi1.jpg) 

 پس از آماده کردن فایل اکسل هویت حقوقی، وارد بانک اطلاعاتی پیامگستر شده و طبق توضیحاتی که در ادامه آمده است مراحل ورود فایل اکسل را انجام دهید.

**نکته:** جهت جلوگیری از ورود اطلاعات تکراری، از قسمت [تنظیمات کلی سیستم ]( https://github.com/1stco/PayamGostarDocs/blob/master/help2.5.4/Settings/General-settings/system/system.md) بخش سیستم تنظیمات مورد نظرتان را اعمال کنید.

![](haghighi2.png) 

برای ورود اطلاعات در داخل یک دسته بندی، بر روی آخرین سطح دسته بندی کلیک راست نموده (در آخرین سطح دسته بندی پوشه‌ی دیگری وجود ندارد)، هویت حقیقی و زیر نوع مورد نظر را انتخاب نمایید. در قسمت شخصی‌سازی می‌توانید زیرنوع‌های هویت را ایجاد کنید؛ برای آشنایی بیشتر به صفحه [شخصی سازی ](https://github.com/1stco/PayamGostarDocs/blob/master/help2.5.4/Settings/Personalization-crm/Overview/General-information/General-information.md) مراجعه کنید. . 
 
پس از انتخاب مسیر دسته بندی بانک اطلاعاتی، پنجره زیر نمایش داده می‌شود. 

> **نکته:** در صورت باز نشدن خودکار پنجره از تنظیمات مرورگر خود Pop-Up Blocking را غیر فعال کنید.

## گام اول:

در این گام باید مسیر فایل اکسل آماده شده و شیوه ورود اطلاعات از اکسل را تعیین کنید و پس از انجام تنظیمات مد نظر روی بخش بعدی کلیک کنید.

![](haghighi3.png) 
 
**1. انتخاب فایل اکسل:** فایل اکسل مورد نظر را برای بارگذاری انتخاب کنید.

**2.روش برخورد با خطا:** میتوانید تعیین کنید که در صورت بروز خطا (تکراری بودن اطلاعات، خالی بودن فیلد اجباری و ...) نرم افزار چگونه عمل کند.

**الف)** اگر روی حالت سعی در اصلاح باشد، خطای پیش آمده را در حین ورود اطلاعات نمایش می‌دهد و می‌توانید یکی از گزینه‌های اصلاح(ویرایش خطا)، ادامه عملیات(در نظر نگرفتن این ردیف از اکسل و وارد کردن سایر ردیف‌ها) یا لغو عملیات (لغو ورود اطلاعات) را انتخاب کنید
 
 ![](haghighi4.jpg) 
 
**ب)** اگر روی وارد نکردن ردیف قرار بگیرد، ردیف‌های دارای خطا را نادیده می‌گیرد و پس از اتمام فرآیند ورود اطلاعات، یک اکسل دارای نام ردیف‌هایی که وارد نشده اند با دلیل وارد نشدن آنها در اختیار شما قرار می‌دهد.

**3.فیلدهای تکراری:** در صورت نیاز نرم افزار می‌تواند بر اساس یک فیلد مرجع (ایمیل، شماره مشتری، موبایل یا تلفن) تکراری بودن مخاطب وارد شده را کنترل کند و در صورت مواجه با این تکرار یکی از چهار رفتار زیر را به انتخاب شما انجام می‌دهد.

**A.** یک پنجره هشدار نمایش می‌دهد و از کاربر می‌خواهد که اطلاعات تکراری را تغییر دهد.

**B.** اطلاعاتی که در اکسل موجود است را بر روی اطلاعاتی که برای همان هویت در نرم افزار موجود است بازنویسی (replace) می‌کند.

**C.** اطلاعاتی که در اکسل موجود است را بر روی اطلاعاتی که برای همان هویت در نرم افزار موجود است بازنویسی (replace ) می‌کند اما فیلدهای از نوع شماره تلفن، موبایل، فکس، تلفکس و آدرس را تغییر نمی‌دهد و اطلاعات از این نوع در اکسل را به همان هویت اضافه می‌کند.

**D.** صرفا فیلدهایی که در اکسل مقدار دارند اما برای آن مخاطب در نرم افزار خالی هستند را پر می‌کند. (برای مثال در اکسل برای آن مخاطب ایمیل وارد شده اما در مخاطبی که برای او ساخته بودیم فیلد ایمیل خالی است.)
 
**E.** **محدود کردن جستجوی تکراری به این دسته بندی:** در صورت فعال کردن فیلدهای تکراری، نرم افزار برای یافتن هویت‌های مشابه با اطلاعات ورودی از اکسل، تنها در این دسته بندی که برای ورود اطلاعات در بانک انتخاب کرده اید، جستجو می‌کند.

## گام دوم:

در گام دوم باید شیوه نگاشت ستون‌های اکسل خود با نرم افزار را تعیین کنید.

![](haghighi5.png) 
 
**1.ستون‌های اکسل:** پارامتر‌های تعریف شده در فایل اکسل (Excel)  شما در ستون سمت راست نمایش داده می‌شود، می‌توانید تک تک پارامترها را با ماوس کشیده و در ستون سمت چپ (ستون فیلدهای پیام گستر ) قرار دهید و روی دکمه ورود اطلاعات کلیک کنید تا اطلاعات اکسل در پیام گستر وارد شود .

**2.نگاشت خودکار ستون‌های هم نام:** ستون‌هایی که نام آنها دقیقاً منطبق با فیلدهای نرم افزار باشد، به صورت خودکار نگاشت می‌شوند و سر جای خود قرار می‌گیرند.

**3.اضافه و ذخیره کردن نگاشت:** اگر اکسلی که وارد می‌کنید تعداد ستون‌های زیادی دارد و نگاشت کردن آن در هر ورود زمان بر است، می‌توانید بعد از اینکه یکبار ستون‌ها را نگاشت کردید، در این قسمت نگاشت را ذخیره کرده و دفعات بعد تنها از لیست این قسمت، نام نگاشت ذخیره شده را انتخاب کنید.

**4.ورود اطلاعات:** برای وارد کردن اطلاعات در بانک اطلاعاتی،  دکمه ورود اطلاعات را انتخاب نمایید. در صورت موفق بودن عملیات با پیغام "عملیات با موفقیت انجام شد" مواجه خواهید شد.

