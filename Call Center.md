
# ماژول مرکز تماس


ماژول ﻣﺮﮐﺰ ﺗﻤﺎس ﭘﯿﺎم ﮔﺴﺘﺮ ﺑﺎ اﺳﺘﻔﺎده از ﺳﺮوﯾﺴﯽ ﺑﻪ ﻧﺎم ﺳﭙﺘﺎ ﺗﻠﻔﻨﯽ  ﻗﺎﺑﻠﯿﺖ اﯾﻦ را دارد ﮐﻪ ﺑﺮاﺳﺎس اﺳﺘﺎﻧﺪاردﻫﺎي ﺗﻌﺮﯾﻒ ﺷﺪه ﮐﻪ در اﯾﻦ آﻣﻮزش ﺑﻪ آﻧﻬﺎ اﺷﺎره ﻣﯿﺸﻮد، ﻻﮔﻬﺎي ﺗﻤﺎس، ﻣﺮاﮐﺰ ﺗﻠﻔﻨﯽﺗﻌﺮﯾﻒ ﺷﺪه در ﭘﯿﺎم ﮔﺴﺘﺮ را ﺑﻪ ﺻﻮرت ﺗﻤﺎس ورودي و ﺧﺮوﺟﯽ و ﯾﺎ ﺗﻤﺎس از دﺳﺖ رﻓﺘﻪ  ﻧﻤﺎﯾﺶ دﻫﺪ. 

![](1.png)

این سرویس با توجه به اینکه از نوع وب سرویس می باشد اما قابلیت این را دارد که در شبکه داخلی یا روی سرور پیام گستر نصب نشود. به طور مثال سیستم تلفنی مشتری در دفتر تهران می باشد اما نرم افزار پیام گستر در دفتر مشهد نصب است. با نصب سرویس تلفنی در دفتر تهران و تنظیمات آن جهت دریافت لاگ تماس در سرویس تلفنی امکان ارسال لاگهای تماس به نرم افزار پیام گستر در دفتر مشهد وجود دارد.(نرم افزار پیام گستر که در دفتر مشهد نصب می باشد حتما باید از طریق بستر اینترنت در دفتر تهران قابل دسترس باشد)

در حال حاضر سرویس تلفنی که تماسها را به پیام گستر منتقل می کند، مراکز تماس زیر را ساپورت می کند:

•	سانترال پاناسونیک

•	خطوط مستقیم (دستگاه دانژه و سگال)

•	ویپ (بر پایه هسته استریسک)

# سرویس تلفنی پیام گستر

•	نصب سرویس تلفنی پیام گستر به .net 4.7.2 نیاز دارد .

•	امکان تنظیم چند سیستم تلفنی برای ارتباط با یک پیام گستر روی
یک سرویس وجود دارد.

•	امکان ارتباط یک سیستم تلفنی با چند پیام گستر وجود دارد.

•	پس از نصب سرویس تلفنی، از محل نصب، Telephony Setting را می توان مشاهده و طبق توضیحاتی که در ادامه  به ازای هر سیستم تلفنی داده شده است، تنظیمات آن را انجام داد.

![](2.png)

در  Telephony Setting  علاوه بر تنظیمات سیستم تلفنی ها، تنظیمات  سرور پیام گستر، برای ارتباط سرویس تلفنی  با پیام گستر هم انجام میشود.

در قسمت Stores Call PayamGostar با زدن دکمه addپنجره زیر باز میشود که تنظیمات آن به شرح زیر است  :


![](3.png)

1-	محل وارد کردن آدرس نرم افزار پیام گستر(آدرس باید با http://  وارد شود.)

2-	محل وارد کردن نام کاربری پیام گستر

3-	محل وارد کردن پسورد، کاربر پیام گستر

نکته : در رابطه با مورد 2 و 3 باید در نظر گرفته شود که نام کاربری و پسوردی وارد شود که در پیام گستر فعال می باشد.(بصورت پیش فرض از ادمین استفاده می شود.)  

در صورت تغییر پسورد کاربر، بایستی  در تنظیمات سرویس تلفنی هم این تغییرات اعمال شود. 

# مرکز تماس سانترال

## سانترال های پاناسونیک قابل پشتیبانی در پیامگستر 

بطور کلی تمامی سانترال هایی که دارای دو لاگ ورودی می باشند : یک لاگ زمانی که تماس در حال رخ دادن می باشد (به بیان دیگرهنگامی که تلفن زنگ می خورد) و یک لاگ دیگر زمانی که تماس برقرار شد و تماس قطع گردید، داشته باشد، توسط پیامگستر پشتیبانی می شود.

همینطور دارای 1 لاگ برای تماسهای خروجی در زمان قطع شدن داشته باشند.


سانترال های قابل پشتیبانی:

TDA  100 , 200 , 600

![](4.jpg)

TDE  100 , 200 , 600

![](5.jpg)

TEM  824,TES  824,TA 824

![](6.jpg)

سانترال غیر قابل پشتیبانی:

KX 1232       

لیست سانترال های تحت شبکه قابل پشتیبانی: (TCP/IP)

NS500,NSX

![](7.jpg)

## نمونه لاگ سانترال 

![](8.jpg)

نکته مهم : دستگاه سانترال جهت نمایش شماره تلفن ها در لاگ تماس حتما باید دارای کارت Caller ID باشد.


•	در لاگ تماس سانترال پارامترهای <I>یا <Input> یا <incoming> نشان دهنده این است که تماس از نوع ورودی می باشد.

•	 در صورتیکه که این پارامتر در لاگ تماس نبود یعنی نوع آن از نوع تماس خروجی است.


•	این لاگها با فعال کردن و انجام یکسری از تنظیمات در خود کنسول  سانترال، فعال و قابل گزارش گیری میشود.(مانند شکل زیرکه کنسول تنظیمات سانترال TDAرا نشان می دهد) 

![](9.jpg)

جهت ارتباط دستگاههای سانترال غیر شبکه ای با سیستم کامپیوتر، از کابل RS232 با سوکتهای 9 پین مادگی استفاده میشود که به شکل زیر می باشد. 

این کابل توسط کارشناس سانترال براساس نقشه ای که در زیر مشاهده میکنید آماده میشود.

![](10.jpg)

یک سر این کابل به سانترال و یک سر آن به PC وصل میشود. (در صورتی که PC پورت COM یا RS232 نداشت از تبدیل RS232 to USB استفاده میکنند)

![](11.png)

با استفاده از نرم افزار Hyper Terminal می توان لاگ های سانترال را بررسی و مشاهده کرد.

## نحوه مشاهده لاگ تماس سانترال در نرم افزار Hyper Terminal 

پس از نصب نرم افزار هایپر ترمینال و اجرای آن، در صورت اتصال سانترال با کابل RS232، در نرم افزار هایپر پورتی که توسط سانترال اشغال شده است را انتخاب می کنیم، تماس ورودی و خروجی را تست میکنیم.
در صورت اتصال سانترال با کابل شبکه TCP/IP مانند سانترال NS500 برای گرفتن لاگ هایپر به IP  و پسورد SMDR نیاز دارید. هایپر ترمینال را اجرا کرده و نوع پورت را بر روی TCP/IP انتخاب کنید و آی پی سانترال و پورت آن را بزنید.  پس از ok کردن صفحه سفیدی باز می شود که باید داخل آن بنویسید smdr و دکمه اینتر را بزنید. سپس ازشما پسورد می خواهد که به صورت پیش فرض pccsmdr است مگر این که  تغییر کرده باشد. سپس روی دکمه اینتر کلیک کنید و منتظر بمانید تالاگ ها نمایش داده شود و در یایان به صورت تستی تماس ورودی و خروجی بگیرید و لاگها را طبق مدل بالا که اشاره شد چک کنید.
بعد از اینکه توسط نرم افزار Hyper Terminal لاگ تماس ها بررسی شد و لاگ های مورد نظر مشاهده شد، تنظیمات در سرویس تلفنی(septa Telephony Setting) انجام میشود تا لاگ  تماس ها به نرم افزار پیام گستر منتقل شود.


## تنظیمات سیستم تلفنی سانترال 

با زدن دکمه Add در Telephony Setting  و انتخاب گزینه Panasonic پنجره زیر باز میشود که تنظیمات آن به صورت زیر می باشد.

![](12.png)

1-	محل وارد کردن کلید برای سرویس تلفنی که در تنظیمات سیستم تلفنی در پیام گستر هم تعریف میشود(این کلید به صورت حروف انگلیسی یا ترکیب حروف انگلیسی و عدد می باشد)

2-	در صورتی که خطوط برای آزاد شدن نیاز به کد (مانند 9 و یا 0) داشته باشند، این کد بایستی در این قسمت تعریف گردد، تا در لاگ تماس های خروجی این کد آزاد نمایش داده نشود و همچنین هنگام استفاده از کلیک تو کال مشکلی برای آزاد کردن خط وجود نداشته باشد.

3-	در این قسمت کد کشور باید تعریف شود.

4-	در این قسمت کد شهر باید تعریف شود.

5-	در این قسمت امکان انتخاب نوع دستگاه سانترال مورد استفاده، وجود دارد.

6-	در این بخش با توجه به فرمت تاریخ در لاگ تماس ها در سانترال، فرمت درست انتخاب میگردد.

7-	نوع ارتباط با سانترال در این بخش انتخاب می گردد.( ارتباط به صورت پورت COM و یا در سانترال های تحت شبکه مانند NS500 بصورت TCP/IP  می باشد.)


8-	در صورت ارتباط از نوع COM ، پورت COM  که سانترال به آن متصل میباشد در این بخش وارد می شود.

9-	محل تعریف سرعت ارتباط با سانترال)این سرعت در سانترال تنظیم میشود(
در صورتی که در مرحله 7 نوع ارتباط روی TCP/IP گذاشته شود باید تنظیمات مربوط به IP Adress ، Port و Login Password مربوط به سانترال NS500 وارد شود.

10-	برای عدم مشاهده داخلی های مربوط به DISA و RingGroup در تماس های ورودی،آن داخلی ها در این قسمت تعریف می گردد.

11-	در این بخش می توان تنظیمات مربوط به ضبط مکالمات را انجام داد.

12-	تنظیمات مربوط به تلسا برای ضبط مکالمات در این قسمت انجام می شود.(در رابطه با ضبط مکالمات در ادامه توضیح داده خواهد شد.)


# خطوط مستقیم

در حال حاضر برای مشتریانی که هیچ نوع سیستم تلفنی ندارند و فقط خطوط شهری دارند، با استفاده از دستگاه سگال می توان لاگهای تماس ورودی و خروجی را به نرم افزار پیام گستر منتقل کرد. 

به این صورت که خطوط شهری ابتدا به دستگاه سگال وصل شده و از دستگاه سگال به تلفن وصل میشود. در پشت دسگاه سگال برای هر خط 2 عدد الین وجود دارد که یکی خروجی و یکی ورودی است.( به طور مثال برای سگال 2 خط، در پشت دستگاه 4 الین وجود دارد) مانند شکل زیر:

![](14.png)

دستگاه سگال از طریق کابل USB به سیستم وصل می شود و با تنظیماتی که در سرویس تلفنی(Septa Telephony Setting) انجام میشود می توان لاگ های خطوط شهری مستقیم، را به پیام گستر منتقل کرد.

همچنین با استفاده از نرم افزار CIDR_Utility می توان لاگ تماسهای ورودی و خروجی را در دستگاه سگال مشاهده کرد و تست کرد.

نمونه تماس خروجی در سگال :

![](15.png)

نمونه تماس ورودی در سگال : 

![](16.png)


•	در خطوط مستقیم هم مانند سانترال نوع تماسهای ورودی و خروجی و از دست رفته مشخص می شود.

## تنظیمات سیستم تلفنی خطوط مستقیم(سگال)

با زدن دکمه Add در Telephony Setting  و انتخاب گزینه Segal پنجره زیر باز میشود که تنظیمات آن به صورت زیر می باشد :

![](17.png)

1-	محل وارد کردن کلید برای سیستم تلفنی که در تنظیمات سیستم تلفنی در پیام گستر هم تعریف میشود(این کلید به صورت حروف انگلیسی یا ترکیب حروف انگلیسی و عدد می باشد)

2-	در صورتی که خطوط برای آزاد شدن نیاز به کد (مانند 9 و یا 0) داشته باشند، این کد بایستی در این قسمت تعریف گردد، تا در لاگ تماس های خروجی این کد آزاد نمایش داده نشود و همچنین هنگام استفاده از کلیک تو کال مشکلی برای آزاد کردن خط وجود نداشته باشد.

3-	در این قسمت کد کشور باید تعریف شود.

4-	در این قسمت کد شهر باید تعریف شود.

5-	تنظیم نوع استفاده از سگال در این بخش انجام میشود.

6-	تنظیمات مربوط به ضبط مکالمات برای خطوط مستقیم سگال در این قسمت فعال می شود.

7-	تنظیمات مربوط به تلسا برای ضبط مکالمات بایستی در این بخش انجام پذیرد. (در رابطه با ضبط مکالمات در ادامه توضیح داده خواهد شد.)

## تنظیمات سیستم تلفنی خطوط مستقیم(دانژه) 

با زدن دکمه Add در Telephony Setting  و انتخاب گزینه Danjeh پنجره زیر باز میشود که تنظیمات آن به صورت زیر می باشد :

![](18.png)

1-	محل وارد کردن کلید برای سیستم تلفنی که در تنظیمات سیستم تلفنی در پیام گستر هم تعریف میشود(این کلید به صورت حروف انگلیسی یا ترکیب حروف انگلیسی و عدد می باشد)

2-	در صورتی که خطوط برای آزاد شدن نیاز به کد (مانند 9 و یا 0) داشته باشند، این کد بایستی در این قسمت تعریف گردد، تا در لاگ تماس های خروجی این کد آزاد نمایش داده نشود و همچنین هنگام استفاده از کلیک تو کال مشکلی برای آزاد کردن خط وجود نداشته باشد.

3-	در این قسمت کد کشور باید تعریف شود.

4-	در این قسمت کد شهر باید تعریف شود.

5-	فعال کردن تنظیمات مربوط به ضبط مکالمات برای خطوط مستقیم دانژه در این قسمت انجام میشود.

6-	انجام تنظیمات مربوط به تلسا برای ضبط مکالمات با استفاده از این بخش صورت می گیرد. .(در رابطه با ضبط مکالمات در ادامه توضیح داده خواهد شد.)

## ضبط مکالمات سانترال و خطوط مستقیم

برای ضبط مکالمات روی مراکز سانترال و خطوط مستقیم از دستگاههای جانبی ضبط مکالمات استفاده میشود که یک نمونه از آن که توسط سرویس تلفنی پیام گستر ساپورت میشود دستگاه تلسا می باشد.

![](18.JPG)

نحوه راه اندازی آن به این صورت است که قبل از ورود هر کدام از خطوط شهری آنالوگ، که به سانترال یا سگال وصل می شود از همان خط هم باید به دستگاه تلسا وصل شود تا در هنگام برقراری تماس و با استفاده از نرم افزاری که برای دستگاه تلسا روی سیستم نصب میشود مکالمات همزمان ضبط شوند تا با تنظیماتی که در سرویس تلفنی انجام میشود مکالمات قابلیت دانلود شدن از طریق پیام گستر را داشته باشد.(برای دانلود مکالمات در پیام گستر نیاز به ماژول ضبط مکالمات می باشد)

نکات مهم :

•	حتما در هنگام اتصال خطوط به تلسا دقت شود که خطی که به ورودی خط 1 سانترال یا سگال خورده است همان خط هم به خط 1 تلسا وصل شود. در صورت جابجا بودن ترتیب خطوط ضبط مکالمات انجام میشود اما سرویس تلفنی قادر به تشخیص مکالمه ضبط شده به علت درست نبودن ترتیب خطوط نمی شود و هنگام دانلود به خطا میخورد.

•	در ضبط مکالمات تلسا، فایل مکالمات ضبط شده در خود سیستمی که به آن تلسا وصل شده است ضبط و آرشیو می شود و سرویس تلفنی پیام گستر با تنظیماتی که انجام میشود قادر به دانلود این فایلها از سیستم مربوط به تلسا می باشد و هیچ فایلی در پیام گستر ذخیره نمیشود. (در صورت پاک شدن یا خراب شدن فایلهای آرشیو شده در نرم افزار تلسا و همینطور تعویض ویندوز یا سیستم تلسا قابلیت دانلود فایلهای قبلی از بین میرود)

•	درایور دستگاه تلسا فقط روی سیستم عاملهای 32 بیتی ساپورت میشود و باید از نصب آن روی سیستم عاملهای 64 بیتی خودداری شود، زیرا در این سیستم عامل ها دستگاه تلسا شناسایی نمی شود. 

•	نصب تلسا بر روی ویندوز های 7 ، 10 ، 8.1  انجام میشود و همچنین بر روی ویندوز های 2008 که 32 بیتی می باشند ساپورت نمی شود.

•	همچنین نصب دستگاه تلسا روی سیستمهای مجازی توصیه نمی شود.

•	دستگاه تلسا به ازای هر دو خط یک ورودی دارد، در نتیجه هر دو خط دریک سوکت قرار گیرد. همچنین ترتیب خطوط ورودی به تلسا اهمیت دارد. مانند شکل زیر:

![](19.png)



•	نرم افزار دستگاه تلسا به دو صورت فولدری ) THW )   یا کامل (دیتابیسی)نصب میشود.
•	 فرق بین این دو مدل این است که در مدل فولدری همه فایلهای مکالمات در یک مسیر به نام record در مسیری که دلخواه مشخص میکنیم، ذخیره میشود.
•	 در حالت دوم همه فایلهای مکالمات ابتدا در هنگام شروع مکالمه ضبط و در همان مسیر record ذخیره میشود و بعد از پایان مکالمه و اتمام ضبط مکالمه از فولدر record حذف و در فولدر Archive براساس شماره خطوط آرشیو میشود.

(امکان خطا در حالت فولدری با توجه به اینکه فایلهای مکالمات آرشیو نمی شوند، هنگام دانلود در سمت پیام گستر بسیار زیاد است)

•	پیش نیازهای نصب تلسا در روش کامل:

•	سیستم عامل 32 بیتی

•	نصب .net 4

•	نصب sql 2000

•	نرم افزار TelsaRecorder_Ver6.2

نکته : با توجه به اینکه در سیستم عامل هایی که .net 4 به بالا روی آن نصب است ، امکان نصب sql2000 (به علت اینکه با .net 4به بالا سازگار نیست)وجود ندارد، با استفاده از روش خاصی می توان sql2005 یا بالاتر را نصب کرد. در غیر اینصورت باید تلسا به روش فولدری نصب شود. 

هنگام نصب نرم افزار تلسا در روش فولدری فقط گزینه TelsaHW انتخاب می شود.

![](20.png)

در روش فول همه گزینه ها بایستی انتخاب شود.

![](21.jpg)

بعد از نصب برنامه در صورتی که تنظیمات و نصب درست انجام شده باشد، مکالمات خطوط ضبط می شود و می توان با استفاده از نرم افزار TelsaStart (که در مسیر نصب برنامه یا آیکون آن که روی دسکتاپ هست) به مکالمات ضبط شده از طریق نرم افزار تلسا دسترسی داشت.

![](22.jpg)

پس از اطمینان از انجام ضبط مکالمات توسط تلسا، می توان تنظیمات آن را در Telephony Setting septa  طبق توضیحات داده شده، انجام داد و فایلهای ضبط شده مربوط به هر تماس را از پیام گستر دانلود کرد.

# مرکز تماس VOIP

سیستمهای ویپ سیستمهایی هستند با استفاده از تجهیزات و نرم افزارهای مربوطه قابلیت استفاده از تلفن را روی خطوط شبکه فراهم می کنند. 
در این ساختار با استفاده از تجهیزاتی مانند کارت یا دستگاههایی مانند gateway خطوط تلفن شهری را به یک نرم افزار (مانند استریسک) یا یک سخت افزار (مانند سیسکو) که قابلیت برنامه ریزی دارد ارتباط داده و از طریق بستری که روی شبکه ایجاد میکنید می توانید با تلفنهای IPPhone یا نرم افزارهایی مانند 3cx بر روی داخلیهایی که برای شما تعریف شده است تماس ورودی یا خروجی داشته باشید.
سرویس تلفنی پیام گستر با استفاده از قابلیتهایی که سیستم های ویپ (مانند استریسک) برای برنامه نویسان گذاشته است، امکان ارتباط با این سیستمها و استفاده از ویژگیهای آن مانند نشان دادن لاگ تماس- دانلود ضبط مکالمات – شنودو نجوا - Click To Call – داشبورد مرکز تماس را در نرم افزار پیام گستر فراهم کرده است. 


## آشنایی با انواع خطوط شهری 

•	آنالوگ : خطوط شهری که از تکنولوژی های قدیمی استفاده میکند و به صورت یک کاناله می باشد و در صورتی که توسط تماسی مشغول شود تا اتمام تماس امکان برقراری ارتباط با آن وجود ندارد.

•	: E1 خطوطی که بر بستر دیجیتال پیاده سازی شده است و در حال حاضر به شماره های 4 یا 5 رقمی معروف است. قابلیت مهمی که دارد این است که شما از روی یک شماره که به شما اختصاص داده میشود قابلیت ورودی همزمان چند تماس متناظر بدون مشغولی را دارید. این خطها به صورت یکطرف ارائه میشوند و امکان گرفتن تماس خروجی از آنها نیست.

•	: SIP Trunk قابلیت خطوط E1 را دارند و عالوه بر آن امکان تماس خروجی از آنها نیز میسر می باشد. 

## آشنایی با استریسک( Asterisk)

استریسک نام نرم افزار متن باز در حوزه تلفن های ویپ است که بر بستر لینوکس نصب می شود و به کمک آن می توان بین چند نقطه تماس تلفنی برقرار کرد. این تماس بدین صورت می باشد که شخصی در یک مکان اقدام به شماره گیری می کند. سیستم تلفنی استریسک در اینجا وظیفه جستجو بین شماره ها و پیدا کردن مکان مقصد را داشته و بعد از مشخص شدن مقصد، اقدام به انتقال صوت به مکان دوم را می نماید. ویژگی اصلی استریسک که باعث محبوبیت آن شده، متن باز بودن آن است و شما می توانید در تمامی دستگاه های IP-PBX راه اندازی کرده وسیستم تلفنی خودتان را مطابق با سلیقه خودتان تغییر دهید.

![](23.jpg)

نحوه کارکرد سیستم تلفنی شما بدین صورت خواهد بود که بعد از ورود تماس به شرکت شما، خطوط تلفن وارد geteway می شوند. geteway تماس ها را وارد شبکه داخلی شرکت و کابل های شبکه شما می نماید. از اینجا به بعد سرور استریسکی که در شبکه شما قرار دارد، با توجه به قابلیت های مختلفی که دارد، تمامی تماس های ورودی، خروجی و حتی داخلی شما را مدیریت خواهد کرد.

### قابلیت های سیستم تلفنی استریسک

مراکز تلفنی ویپ که با عنوان IP-PBX شناخته می شوند محل قرارگیری سیستم نرم افزاری استریسک می باشند که به کمک آن ها شما می توانید بر روی تمامی تماس های ورودی، خروجی و حتی داخلی شرکتتان مدیریت کنید. استریسک این قابلیت را دارد که متناسب با سلیقه شما برنامه ریزی شود و سیستم تلفنی شما را به یک سیستم کامل شخصی سازی شده تبدیل کند.

### اپراتور هوشمند در استریسک

سیستم تلفنی استریسک به صورتی برنامه نویسی شده است که بعد از ورود تماس به سیستم تلفنی،  منوی صوتی را برای تمامی تماس ها پخش می کند. در صوت پخش شده، شماره داخلی بخش های مختلف شرکت معرفی می شوند و از تماس گیرنده خواسته می شود تا با شماره گیری داخلی مورد نظر ارتباط خود را با آن بخش برقرار کنند. بعد از انتخاب واحد مورد نظر، استریسک به طور خودکار اقدام به انتقال تماس به بخش مربوطه را می نماید.

### ساخت تعداد نامحدودی داخلی در استریسک

در استریسک شما می توانید به راحتی و با استفاده از پروتکل های SIP و IAX اقدام به ساخت داخلی نمایید و ازین جهت برای شما محدودیتی وجود نداشته و می توانید به تعداد دلخواهی داخلی با کاربری های مختلف به اپراتور های خودتان اضافه کنید.

### انتقال تماس در استریسک

در سیستم تلفنی استریسک شما می توانید تماس های ورودی به هر داخلی  را به خط دیگری که می خواهید منتقل کنید. برای این منظور تنها کافیست برای هر کدام از داخلی ها یک شماره ثابت یا همراه تعریف کنید و بدین ترتیب بعد از برقراری تماس با آن داخلی، تماس به شماره وارد شده منتقل می شود و شما می توانید در مکان دیگری پاسخگویی تماس را داشته باشید.

### صف انتظار در سیستم استریسک

در سیستم تلفنی ویپ تماس های ورودی به شرکت به طور مستقیم به داخلی ها وصل نمی شوند و در ابتدا وارد صف انتظار خواهند شد. در صف تماس نیز در حین پخش آهنگ انتظار برای مشتریان شما، شعارهای تبلیغاتی پخش خواهد شد ومی توان اعلام  شود که چندمین نفر در صف پاسخگویی می باشد و زمان تقریبی پاسخگویی نیز برای جلب رضایت تماس گیرنده محاسبه و گفته خواهد شد.

### فرق بین استریسک و الستیکس :

الستیکس Elastix یک سیستم تلفنی مبتنی بر Asterisk است و به عنوان محبوب ترین سیستم استریسکی کد باز شناخته می شود.

الستیکس Elastix یک سیستم تلفنی مبتنی بر Asterisk است و به عنوان محبوب ترین سیستم استریسکی کد باز شناخته می شود.
الستیکس مجموعه ای از برنامه ها و ابزارهایی است که پس از ترکیب ، یک IP PBX کامل و جامع را پدید آورده است . Elastixیک سیستم ارتباطی و مرکز تلفنی کامل و جامع می باشد که با بسیاری از سخت افزارها ، نرم افزارها و تجهیزات ارتباط تلفنی کامل سازگار است و بدین جهت به راحتی می تواند با دیگر مراکز تلفن رقابت کند. الستیکس دارای یک رابط گرافیکی ساده و تحت وب می باشد که می توان به راحتی از آن استفاده نمود و نیاز به دانش برنامه نویسی ندارد و تمام قابلیت های آن با استفاده از صفحات و کلیدهای از پیش تعیین شده قابل تغییر و برنامه ریزی می باشد. باتوجه به قابلیت های فوق العاده ای که سیستم الستیکس دارد می توان از آن بعنوان یک منشی تلفنی دیجیتال ساده برای شرکت های کوچک و یا یک مرکز تماس کامل و پیشرفته برای سازمانهای بزرگ استفاده نمود.

پس به طور کلی استریسک یه نرم افزار تلفنی است که کارش مدیریت داخلی ها، تماس ها و ... است. این نرم افزار هیچ اینترفیسی ندارد و به صورت یک هسته است. شرکت های مختلفی مثل freepbx برای این نرم افزار یک اینترفیس تحت وب طراحی کردند

که به راحتی می توانید داخلی تعریف کنید، تماس های ورودی رو route کنید و کلی امکانات دیگر که به راحتی قابل انجام دادن است را از طریق یک رابط گرافیکی انجام دهید. الستیکس هم بر روی freepbx اینترفیس خودش را طراحی کرده و با نام الستیکس این نرم افزار رو ابتدا به صورت open source و رایگان و سپس به صورت تجاری عرضه کرده. است.


# آشنایی با محیط الستیکس 

سیستم الستیکس جهت مدیریت دارای یک رابط گرافیکی تحت وب می باشد که با زدن آی پی و نام کاربری و رمز عبور معتبر می توان به پنل آن دسترسی داشت.
صفحه ورودی سیستم الستیکس که در آن میزان منابع استفاده شده توسط الستیکس از رم و هارد و سی پی یو سیستمی که بر روی آن نصب شده است را به صورت گرافیگی نشان میدهد: 

![](24.jpg)

صفحه مربوط به تنظیمات سیستم الستیکس که در آن تنظیمات مربوط به داخلیها و صفهای تماس و خطوط ورودی انجام میشود  :

![](25.jpg)

صفحه مربوط به دیدن گزارشات لاگ های تماس ورودی و خروجی در سیستم ویپ : 

![](26.jpg)


صفحه مربوط به نمایش مکالمات ضبط شده در سیستم ویپ جهت دانلود یا شنیدن مستقیم آن:


![](27.jpg)

جهت برنامه نویسی در سیستم ویپ استریسک یک کاربر به نام ami تعریف شده است که از آن می توان به Eventها و دستورات مورد نیاز جهت ارتباط با برنامه های دیگر استفاده کرد. سرویس تلفنی پیام گستر هم با استفاده از این کاربر و ارتباط با آن می تواند قابلیتهای لاگ تماس – شنود و نجوا – کلیک تو کال – و داشبورد مرکز تماس را با استفاده از نرم افزار پیام گستر پشتیبانی کند.(در رابطه با این قابلیت ها در ادامه توضیح داده خواهد شد.) 

## تنظیمات سیستم تلفنی ویپ 

سیستم تلفنی پیام گستر با استفاده از نام و رمز کاربری ami که در سیستمهای ویپ الستیکس در فایل manager.conf قابل مشاهده است (که امکان تغییر آن هم وجود دارد) با سیستم ویپ ارتباط برقرار کرده و در صورتی که براساس DialPlanهایی که در سیستم ویپ برقرار است و Eventهایی که از سیستم ویپ می گیرد براساس برنامه نویسی انجام شده قادر به استخراج لاگهای تماس ورودی و خروجی و داخلیهای مرتبط با آن و قرار دادن آن در نرم افزار پیام گستر می باشد. بعد از بدست اوردن نام کاربری و رمز عبور ami تنظیمات آن در septa Telephony Setting (سرویس تلفنی) انجام میشود و بعد از استارت کردن سرویس، لاگهای تماس در نرم افزار پیام گستر هم قابل مشاهده است.

با زدن دکمه Add در Telephony Setting و انتخاب گزینه Asterisk پنجره زیر باز میشود که تنظیمات آن به صورت زیر می باشد :

![](28.png)

1-	محل وارد کردن کلید برای سیستم تلفنی که در تنظیمات سیستم تلفنی در پیام گستر هم تعریف میشود(این کلید به صورت حروف انگلیسی یا ترکیب حروف انگلیسی و عدد می باشد(

2-	در صورتی که خطوط برای آزاد شدن نیاز به کد (مانند 9 و یا 0) داشته باشند، این کد بایستی در این قسمت تعریف گردد، تا در لاگ تماس های خروجی این کد آزاد نمایش داده نشود و همچنین هنگام استفاده از کلیک تو کال مشکلی برای آزاد کردن خط وجود نداشته باشد.

3-	در این قسمت کد کشور باید تعریف شود.

4-	در این قسمت کد شهر باید تعریف شود.

5-	آدرس سرور سیستم تلفنی ویپ در این قسمت تعریف می شود.

6-	محل وارد کردن پورت  AM I (که به صورت پیش فرض 5038 می باشد.)

7-	محل وارد کردن نام کاربری مروبط به AM I 

8-	محل وارد کردن پسورد مربوط به  AM I 

9-	در این بخش ورژن استریسک یا سیستم تلفنی مرتبط انتخاب می شود.

نکته مهم : در حال حاضر سرویس تلفنی پیام گستر سیستمهای ویپ دارای هسته استریسک که ورژن آنها 1 یا 1.8 یا 11 یا 13 است را پشتیبانی می کند به شرطی که بتواند Eventهای مربوطه را از آن را به صورت درست دریافت کند.

10-	با استفاده از این کلید می توان تنظیمات مراحل 5 الی 8 ، ارتباط با ویپ و کاربر AM I  را تست کرد.

11-	با زدن این دکمه در صورت آشنایی با دستورات ویپ می توان بعضی از دستورات را اجرا کرد.

12-	دستور Orginate برای استفاده از کلیک تو کال )در سیستمهای تلفنی استریسک به صورت پیش فرض این دستور
from-internal می باشد(می باشد.

13-	در این بخش می توان خارج از نرم افزار پیام گستر، از همین قسمت تست کلیک تو کال را انجام داد.

14-	 محل وارد کردن پورت SSH برای ارتباط با سیستم عامل ویپ برای تنظیمات ضبط مکالمات(که بصورت پیش فرض 22 می باشد.)

15-	محل وارد کردن پورت SFTP   برای ارتباط با سیستم عامل ویپ برای تنظیمات ضبط مکالمات یا پورت FTP  برای ارتباط با سیستم عامل، سیستمهای غیر الستیکس(مانند MYBPX) برای تنظیمات ضبط مکالمات

16-	در این بخش نام کاربری که به مسیر ضبط مکالمات در ویپ دسترسی دارد وارد می شود(بصورت پیش فرض کاربر ROOT این دسترسی را دارد.)

17-	. محل وارد کردن پسورد نام کاربری تنظیم شده در مرحله 16

18-	با استفاده از این کلید می توان تنظیمات مراحل 14 تا 17 را تست کرد.

19-	با انتخاب این گزینه ضبط مکالمات برای سیستم ویپ در سرویس تلفنی فعال میشود.

20-	مسیر ضبط مکالمات در سیستم ویپ در صورتی که در مسیر پیش فرض نباشد در این قسمت وارد می شود.( مسیر پیش فرض var/spool/asterisk/monitor می باشد.)

21-	تنظیمات انجام شده با استفاده از این کلید ذخیره میگردد. 

نکته مهم : در حال حاضر سرویس تلفنی پیام گستر سیستمهای ویپ دارای هسته استریسک که ورژن آنها 1 یا 1.8 یا 11 یا 13 است را پشتیبانی می کند به شرطی که بتواند Eventهای مربوطه را از آن را به صورت درست دریافت کند.

## ضبط مکالمات ویپ

در صورتی که ضبط مکالمات در سیستم ویپ انجام شود سرویس تلفنی پیام گستر قابلیت آن را دارد که با استفاده از نام کاربری که در لینوکس به مسیر ضبط مکالمات دسترسی دارد مکالمات ذخیره شده را دانلود نماید. این نام کاربری یا باید root لینوکس باشد یا مجوز دسترسی به فایلهای ضبط مکالمات را داشته باشد.

الزم به ذکر است که مسیر ضبط مکالمات در سیستمهای ویپ به صورت پیش فرض در لینوکس var/spool/asterisk/monitor می باشد که در این مسیر براساس هر سال و ماه و روز یک فولدر ایجاد میشود و فایلهای ضبط مکالمات در آن قرار می گیرد. در حال حاضر سرویس تلفنی پیام گستر قادر به دانلود فایلهایی است که در این مسیر ذخیره شده است و در صورتی که مسیر ذخیره مکالمات تغییر کند در حال حاضر قابلیت پشتیبانی از آن وجود ندارد و همینطور پورتی که برای ارتباط با لینوکس سرویس تلفنی استفاده می کند همان پیش فرض 22است و  در صورت تغییر هم سرویس تلفنی قادر به ارتباط با لینوکس نیست.

# تنظیمات سیستم تلفنی در پیام گستر


تنظیمات مربوط به سیستم تلفنی در پیام گستر از مسیر:  اطلاعات پایه < سیستم های تلفنی< مدیریت سیستم های تلفنی بایستی انجام شود.

![](13.png)

پس تنظیم سرویس تلفنی بایستی برای ارتباط سرویس تلفنی با پیام گستر این تنظیمات  در پیام گستر  انجام گردد که برای همه سیستم تلفنی ها(سانترال،ویپ و ...) به همین صورت می 

نکته :در صورتی که هنگام تنظیمات سیستم تلفنی در پیام گستر تیک خطوط تماس و خطوط داخلی جدید در سیستم ثبت شوند، زده نشود می توانیم به صورت دستی خطوط و داخلیهایی که می خواهیم لاگ آنها در پیام گستر مشاهده کنیم را مشخص کنیم.

پس از تنظیمات انجام شده واطمینان از درست بودن همه تنظیمات،بایستی سرویس septa Telephony service از مسیر services استارت شود . 



# Click to Call در سیستم ویپ

Click to Call  قابلیتی است که در نرم افزار پیام گستر امکان شماره گیری ، شماره های ثبت شده در پیام گستر را از طریق ارتباط سرویس تلفنی با سیستم ویپ می دهد. بایستی تنظیمات مربوط به کلیک تو کال در پیام گستر هم انجام شود:
 بدین صورت که بایستی برای کاربر مربوطه، داخلی متناظری که در سیستم ویپ دارد، تعریف شود(در بخش مدیریت گروه ها و کاربران در قسمت ویرایش هر کاربر، بخش داخلی ها می توان برای کاربر داخلی متناظر را تعریف کرد و همچنین از مسیر اطلاعات پایه<سیستم های تلفنی<مدیریت سیستم های تلفنی، هم می توان داخلی های مربوط به هر کاربر را تعریف کرد.) و همچنین کاربر باید دارای مجوز برقراری تماس تلفنی باشد(این مجوز از بخش مجوز های عمومی، قسمت مجوز های مرکز تماس بایستی به کاربر اختصاص داده شود.)
 
در صورتی که در پروفایل مربوطه روی علامت تلفن، پشت شماره تلفن یا موبایل کلیک کند شماره مرتبط، از پیام گستر به سرویس تلفنی و از طریق سرویس تلفنی در صورت درست بودن تنظیمات با ویژگی orginate به سیستم ویپ منتقل میشود. در این حالت داخلی کاربر روی IPPhone یا نرم افزار تلفنی زنگ میخورد و در صورت جواب دادن عمل شماره گیری شماره انتخاب شده انجام میشود.( این مورد باید در نظر گرفته شود که حتما باید داخلی کاربر روی نرم افزار تلفنی برای مثال  3cx تنظیم شده باشد.) 

![](29.png)

در صورتی که برای تماس خروجی از طریق سیستم تلفنی ویپ از طریق داخلی ها برای آزاد کردن خط نیاز به شماره گیری 9 یا 0 یا هر عدد دیگری می باشد این تنظیمات باید در  septa Telephony Setting )سرویس تلفنی( انجام شود.

# داشبورد مرکز تماس و شنود و نجوا در پیامگستر 

در صورت استفاده از سیستم تلفنی سانترال داشبورد مرکز تماس و همچنین در صورت استفاده ازسیستم تلفنی ویپ داشبورد مرکز تماس، قابلیت شنود و نجوا، از مسیر پنجره ها< وضعیت مرکز تماس< داشبورد مرکز تماس در پیام گستر در دسترس خواهد بود.
 که  وضعیت کلیه خطوط داخلی که در حال مکالمه با چه شماره ای می باشد و یا آزاد هستند، را از سیستم تلفنی خوانده و به صورت آنلاین نمایش میدهد.

![](30.jpg)

## شنود

قابلیتی است که در سیستم تلفنی ویپ قابل استفاده می باشد و با استفاده از آن می توان از طریق داشبورد مرکز تماس  روی یک داخلی، بدون اینکه داخلی مورد نظر متوجه شود، مکالمه آن را شنود کرد.به این صورت که در داشبورد مرکزتماس روی تماس مورد نظرگزینه شنود را کلیک کرده و بعد از اینکه داخلی که برای کاربرمان تنظیم کرده ایم نمایش داده شد، شنود را مجدد می زنیم و داخلیمان زنگ میخورد و روی آن SPY هم دیده میشود.در صورت جواب دادن عملیات شنود صورت میپذیرد.

![](31.png)

![](32.jpg)

## نجوا 

قابلیتی است در سیستم تلفنی ویپ قابل استفاده می باشد، که با استفاده از آن می توان از طریق داشبورد مرکز تماس روی یک داخلی نجوا انجام داد و به یک کارشناس در حال صحبت با مشتری یا شخص دیگر بدون متوجه شدن شخص ثالث راهنمایی در هنگام مکالمه داد.

به این صورت که روی تماس مورد نظر در داشبورد مرکزتماس روی گزینه ارسال پیغام به کارشناس کلیک کرده و بعد از اینکه داخلی که برای کاربرمان تنظیم کرده ایم نمایش داده شد نجوا را مجدد می زنیم و داخلیمان زنگ میخورد و روی آن Wisper هم دیده میشود.در صورت جواب دادن عملیات نجوا صورت میپذیرد.

![](33.jpg)

![](34.png)

# ماژول رویداد تماس

با استفاده از این ویژگی در پیام گستر برای تماسهای مرکز تماس قابلیت ارسال پیام اتوماتیک از طریق پیامک یا ایمیل یا فکس وجود دارد.همچنین قابلیت ایجاد فرم اتوماتیک در سیستم برای تماسهای مرکز تماس وجود دارد.

نکته مهم : برای استفاده از این قابلیت مشتری باید ماژولهای رویداد تماس را خریداری کند. در ضمن برای اینکه بتواند برای هویتهای ثبت نشده در سیستم هم پیام ارسال شود و یا فرم ایجاد شود، بایستی ماژول مخاطبان ناشناس هم داشته باشند.

# تلفن 

در نوار دسترسی بخشی به نام تلفن برای نمایش تماس ها و همچنین شماره گیری وجود دارد که شامل سه بخش می باشد :

![](35.png)

1 شماره گیر -2تماسهای جاری و -3 سابقه تماس وجود دارد.


-1 شماره گیر : در صورت تعریف کردن داخلی برای کاربر و تنظیم موارد مربوط به کلیک تو کال در سیستم تلفنی برای ویپ ، امکان گرفتن شماره به صورت دستی یا با استفاده از dialpad وجود دارد.

نکته : برای استفاده از این بخش کاربر باید دارای مجوز برقراری تماس باشد.

![](36.jpg)

2 تماسهای جاری : هنگامی تماس در این قسمت نمایش داده میشود که تماس درحال انجام باشد یعنی در حال زنگ خوردن باشد یا با داخلی در حال مکالمه باشد.

![](37.jpg)

نکات مهم :

•	در صورت محدود شدن تماس ها بر اساس داخلی، زمانی تماس در قسمت تماس جاری نمایش داده می شود که سیستم تلفنی حتما ویپ باشد و تنظیمات مربوطه (محدود کردن مشاهده تماسها براساس داخلی – تعریف داخلی مرتبط برای کاربر – مجوز مشاهده تماس های دریافتی) انجام شده باشد.  . با توجه به توضیحات انجام شده پاپ آپ پروفایل در صورت محدود کردن تماسها براساس داخلی فقط در سیستمهای ویپ امکان پذیر است.

•	در سیستم تلفنی سانترال امکان پاپ آپ پروفایل، پس از قطع تماس وجود دارد.

•	در صورتی که سیستم سانترال باشد عمال محدود کردن تماسها براساس داخلی ساپورت نمی شود چون در تماسهای ورودی سانترال زمانی داخلی تشخیص داده میشود که تماس قطع شده باشد. برای سیستمهای سانترال و خطوط مستقیم می توان از محدود کردن تماس براساس کارشناس پروفایل استفاده شود. . با توجه به توضیحات انجام شده پاپ آپ پروفایل در سیستمهای تلفنی سانترال فقط براساس محدود کردن تماسها براساس کارشناس پروفایل امکان پذیر است.(در رابطه با نحوه محدود کردن تماس ها در ادامه توضیح داده خواهد شد.)


-3 سابقه تماس : تماس هایی که در قسمت تماسهای جاری می باشد پس از اتمام تماس در قسمت سابقه تماس قرار می گیرد.

نکته مهم : در سیستمهای تلفنی ویپ به محض قطع شدن تماسی که در قسمت تماس جاری قرار دارد به قسمت سابقه تماس منتقل میشود.
 در سیستمهای سانترال در صورتی که تنظیمات ضبط مکالمات تلسا هم در سرویس تلفنی داشته باشد به همین صورت می باشد(چون قطع شدن تماس به وسیله تلسا تشخیص داده میشود) اما در صورت نداشتن این تنظیمات با تاخیر این مورد صورت میگیرد.

![](38.jpg)


در سابقه تماس تماسهای اتمام یافته، براساس زمان به صورت نزولی نمایش داده میشود.

نکته بسیار مهم : با رفرش شدن صفحه یا زدن Ctrl+F5، کلیه سوابق تماس پاک میشود و این مورد جزو رفتار سیستم می باشد.


# نحوه محدود کردن مشاهده تماس ها 
پیام گستر قابلیت محدود کردن مشاهده تماس ها برای کاربران را فراهم می کند. 
این محدودیت می تواند براساس داخلی های تعریف شده برای کاربران باشد و هم چنین امکان محدود کردن مشاهده تماس برای کارشناسان پروفایل وجود دارد، بدین معنی که فقط مسئولان پروفایل(مسئول فروش،مسئول پشتیبانی و مسئول متفرقه) امکان مشاهده تماس آن پروفایل را دارند.

این تنظیمات از بخش تنظمیات < تنظیمات کلی< تماس ها انجام می شود 


![](39.png)










































