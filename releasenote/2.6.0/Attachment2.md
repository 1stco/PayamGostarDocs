# پیوست شماره 2 (ورود اطلاعات برخی سوابق از طریق اکسل) 

ورود اطلاعات آیتم‌های فرم، قرارداد، پرداخت/دریافت از طریق اکسل، قابلیت جدیدی است که در این ورژن قابل‌استفاده است. 

در این راهنما مراحل ورود اطلاعات، نکات و فرمت صحیح اطلاعات برای ورود از طریق اکسل توضیح داده شده است. ابتدا به بیان توضیحات مشترک در خصوص ورود اطلاعات پرداخته و سپس توضیحات اختصاصی ورود اطلاعات هر موجودیت مطرح شده است.

###  توضیحات مشترک برای ورود اطلاعات موجودیت‌ها

برای ورود اطلاعات، می‌توانید در لیست آیتم‌های ذکر شده در بالا، با استفاده از کلید ورود اطلاعات از طریق اکسل اقدام نمایید.

## 1) مرحله اول (بارگذاری فایل) 

در گام اول نوع و زیر نوع آیتم انتخاب شده نمایش داده می‌شود. 

اگر لیست آیتم‌ها بر روی نمایش همه (برای مثال همه‌ی فرم‌ها) باشد، در این گام زیر نوع به‌صورت خودکار نمایش داده می‌شود که می‌توان آن را ویرایش کرد.

در این مرحله می‌توانید فایل اکسل نمونه‌ای را دانلود کنید، این فایل شامل تمامی فیلدهای نوع آیتم انتخاب شده می‌باشد که با واردکردن اطلاعات خود در فایل نمونه و ایمپورت آن می‌توانید ورود اطلاعات از طریق اکسل را با فرمت صحیح انجام دهید.

> نکته: فیلدهای اضافه از نوع Html، برچسب، تصویر، رنگ، فایل، کمپین، فیلدهای لیستی و فیلد آیتم‌های crm (جز فیلد شرکت/شخص) در فایل نمونه قابل‌مشاهده نمی‌باشند.
در این مرحله فایل اکسل خود را انتخاب یا از طریق drag & drop آپلود کنید، با کلیک بر روی مرحله بعد وارد مرحله دوم شوید.

## 2) مرحله دوم (تنظیمات) 

### انتخاب روش‌های ورود اطلاعات:

**1)    افزودن اطلاعات جدید:** با انتخاب این روش آیتم‌های موجود در فایل اکسل به نرم‌افزار اضافه می‌شوند.
می‌توانید یکی از فیلدهای موجود در بخش مبنای شناسایی را انتخاب کنید تا بر اساس آن جستجوی تکراری بودن انجام شود، در صورت تکراری نبودن مقدار مبنای انتخاب شده، آن آیتم به نر‌‌م‌افزار اضافه می‌شود.

**2)    ویرایش اطلاعات موجود:** در این روش بر اساس فیلدی که به‌عنوان مبنا انتخاب شده است، جستجوی تکراری بودن انجام می‌شود و در صورت تکراری بودن مقدار مبنای انتخاب شده، آیتم دارای این اطلاعات ویرایش می‌شود.
با انتخاب چک باکس " فقط فیلدهای خالی پر شوند " تنها فیلدهای خالی آیتم در حال ویرایش مقداردهی می‌شوند.

**3)    افزودن و ویرایش:** در این روش بر اساس فیلد مبنای انتخاب شده جستجو انجام می‌شود، در صورت تکراری بودن اطلاعات آن فیلد، آیتم دارای این اطلاعات ویرایش می‌شود و در صورت تکراری نبودن، آیتم جدید به نرم‌افزار اضافه می‌شود.
با انتخاب چک باکس " فقط فیلدهای خالی پر شوند " تنها فیلدهای خالی آیتم در حال ویرایش مقداردهی می‌شوند.

## 3) مرحله سوم (نگاشت فیلدها) 

در مرحله سوم سرستون‌های فایل اکسل در بخش فیلدهای شما نمایش داده می‌شود، و فیلدهای موجود در آیتم در بخش فیلدهای ماشین شما نمایش داده می‌شود.

با drag & drop فیلدها، امکان نگاشت آنها با فیلدهای سیستم وجود دارد.

فیلدهای هم‌نام به‌صورت خودکار نگاشت می‌شوند و همچنین با انتخاب "نگاشت فیلدهای هم‌نام" امکان نگاشت وجود دارد.

شما می‌توانید نگاشت موردنظر خود (به جز نگاشت فیلدهای لیستی) را با استفاده از "ذخیره نگاشت" ذخیره کنید و در صورت نیاز از لیست نگاشت‌ها آن را انتخاب کنید.

در لیست نگاشت‌های من امکان ویرایش یا حذف نگاشت ذخیره شده وجود دارد. 

لازم به ذکر است امکان نگاشت "یک" فیلد لیستی در هر بار ورود اطلاعات وجود دارد، برای این کار فیلد لیستی موردنظر را از لیست انتخاب کرده و نگاشت فیلد را انجام دهید.

> نکته: درصورتی‌که فیلدی در سیستم دارای مقدار پیش‌فرض باشد در این بخش قابل‌مشاهده و ویرایش می‌باشد، همچنین می‌توانید برای فیلدها در این بخش مقدار پیش‌فرض تعریف کنید تا در صورت خالی بودن این فیلد در فایل اکسل، در نرم‌افزار فیلد با این مقدار پیش‌فرض، مقداردهی شوند.

## 4) مرحله چهارم (شروع بارگذاری) 

در صورت مشکل در بارگذاری اطلاعات، خطای مرتبط در این گام نمایش داده می‌شود و فایل اکسلی شامل آیتم‌های دارای خطا قابل دریافت می‌باشد که پس از اصلاح خطاها بارگذاری مجدد فایل انجام شود.

در منوی گزارش‌ها، بخش وضعیت عملیات انبوه می‌توان نتایج ورود اطلاعات را مشاهده کرد، همچنین در صورت بروز خطا، می‌توان از این بخش فایل اکسلی شامل آیتم‌های دارای خطا و علت خطای رخ داده دریافت نمود.

#### 1.2)    نکات مشترک برای ورود اطلاعات موجودیت‌ها

•    امکان ورود اطلاعات فیلدهای از نوع فایل، تصویر، html، کمپین، برچسب، لیست مرتبط، فیلد آیتم‌های سی آر ام (جز فیلد شخص/شرکت)، فیلد اضافه از نوع رنگ، فیلد لیستی از نوع فایل، فیلد لیستی از نوع کاربر/گروه و فیلد لیستی آیتم سی آر ام از طریق اکسل وجود ندارد.

•    در فایل اکسل فیلدهای مبنا باید باهمان نام تعریف شوند، برای نمونه در صورت انتخاب "شماره" ی قرارداد به‌عنوان مبنا، در اکسل هم باید نام ستون شماره باشد.

•    برای فیلدی که به‌عنوان مبنا انتخاب شده است و فیلدهای اجباری آن آیتم، می‌بایست حتماً نگاشت انجام شود و در فایل اکسل مقداردهی هم شده باشند، در غیر این صورت، روند با خطا روبه‌رو می‌شود.

•    در صورت انتخاب فیلد از نوع شناسه خودکار به‌عنوان مبنا برای آیتم‌ها، این فیلد صرفاً برای شناسایی آیتم‌ها استفاده می‌شود و مقادیر وارد شده برای آن در اکسل در سیستم وارد نمی‌شود.

•    فیلدهایی از نوع لیست کشویی پیش‌فرض (فیلدهای موجود در مدیریت آیتم‌های سیستم) مانند نوع پرداخت یا روش پرداخت باید مطابق مقادیر موجود در نرم‌افزار مقداردهی شوند، همچنین اگر در این فیلدها دو مقدار همنام وجود داشته باشد، هنگام بارگذاری اطلاعات اگر این مقدار همنام در اکسل تعریف شده باشد، آن فیلد در نرم‌افزار مقداردهی نمی‌شود و خطا می‌دهد.

•    در هنگام ویرایش، اگر بر اساس مبنای انتخاب شده، چندین آیتم در نرم‌افزار وجود داشته باشد و هیچ فیلد لیستی نگاشت نشده باشد، هیچ‌کدام از آیتم‌ها ویرایش نمی‌شوند.

•    در حالت ویرایش، باید زیر نوع آیتم در حال ویرایش و زیر نوع آیتم انتخاب شده در گام اول یکسان باشد، در غیر این صورت بارگذاری انجام نمی‌شود.

### 1.3)    مجوزهای مشترک برای ورود اطلاعات موجودیت‌ها


#### مجوز افزودن اطلاعات جدید: 

•    برای افزودن اطلاعات جدید در مرحله دوم کاربر باید مجوز ذخیره اولیه آیتم را در نوع آیتم انتخاب شده داشته باشد.

#### مجوز ویرایش اطلاعات موجود:

•    برای ویرایش اطلاعات موجود در مرحله دوم کاربر باید مجوز ویرایش آیتم را در نوع آیتم انتخاب شده داشته باشد.

#### مجوز افزودن و ویرایش:

•    برای افزودن و ویرایش اطلاعات در مرحله دوم کاربر باید مجوز ذخیره اولیه آیتم و ویرایش آیتم را روی نوع آیتم انتخاب شده داشته باشد.

#### مجوز ویرایش مرتبط با: 

•    کاربر برای ویرایش پروفایل مرتبط با آیتم علاوه بر مجوز ویرایش آیتم باید مجوز ویرایش مرتبط با را بر روی نوع آن آیتم داشته باشد.

## 2) ورود اطلاعات فرم‌ها از طریق اکسل

#### 2.1) فرمت صحیح ورود اطلاعات فرم‌ها

•    **فیلد تاریخ:** روز/ماه/سال

•    **فیلد چک باکس:** true /false، بلی/خیر، yes/no، 0/1

•    **فیلد ساعت:** 00:00

•    **فیلد کاربر:** نام کاربری یا کلید کاربر

•    **پروفایل مرتبط:** نام هویت یا شماره مشتری

•    **فیلد لیستی:** می‌بایست به‌ازای هر مقدار لیست، رکورد مربوطه در فایل اکسل تکرار گردد. همچنین در این حالت، اطلاعات فیلد رکورد آخر به همراه تمام مقادیر فیلد لیستی آن که در رکوردهای مربوطه وارد شده است، در سیستم وارد می‌گردد. مثال فیلد لیستی: لیست عدد، لیست متن

#### 2.2) نکات مربوط به ورود اطلاعات فرم‌ها

•    در مرحله دوم می‌توانید یکی از فیلدهای عنوان فرم، فیلدهای اضافه‌‎ی (از نوع متن، عدد و شناسه خودکار) روی موجودیت اصلی فرم و زیر نوع موردنظر را به‌عنوان مبنای شناسایی انتخاب کنید. درصورتی‌که فیلد "هیچ‌کدام" به‌عنوان مبنا انتخاب شود، تمام فرم‌های موجود در اکسل به نرم‌افزار اضافه می‌شوند.

•    توجه داشته باشید در صورت اعمال تنظیمات ثبت عنوان خودکار در بخش شخصی‌سازی برای فرم انتخابی، در ورود فرم‌های جدید یا ویرایش فرم‌های موجود از مقادیر فیلد عنوان در فایل اکسل صرف‌نظر خواهد شد و طبق الگو تنظیم شده برای این نوع فرم، عنوان فرم‌ها به‌صورت خودکار برای فرم‌های جدید درج خواهد شد و در فرم‌های موجود این فیلد ویرایش نمی‌شود. همچنین در این صورت در روش افزودن فرم جدید و روش افزودن و ویرایش، عنوان فرم برای انتخاب مبنا نمایش داده نمی‌شود.

## 3)ورود اطلاعات قراردادها از طریق اکسل

#### 3.1) فرمت صحیح ورود اطلاعات قراردادها

•    **فیلد تاریخ:** روز/ماه/سال

•    **فیلد چک باکس:** true /false، بلی/خیر، yes/no، 0/1

•    **فیلد کاربر:** نام کاربری یا کلید کاربر

•    **فیلد ساعت:** 00:00

•    **شماره قرارداد:** بر اساس قالب شماره‌گذاری آن نوع موجودیت 

•    **پروفایل مرتبط:** نام هویت یا شماره مشتری

•    **فیلد لیستی:** می‌بایست به‌ازای هر مقدار لیست، رکورد مربوطه در فایل اکسل تکرار گردد. همچنین در این حالت، اطلاعات فیلد رکورد آخر به همراه تمام مقادیر فیلد لیستی آن که در رکوردهای مربوطه وارد شده است، در سیستم وارد می‌گردد. مثال فیلد لیستی: لیست عدد، لیست متن

#### 3.2)نکات مربوط به ورود اطلاعات قراردادها

•    در مرحله‌ی دوم می‌توانید یکی از فیلدهای عنوان قرارداد، شماره قرارداد، فیلدهای اضافه‌‎ی (از نوع متن، عدد و شناسه خودکار) روی موجودیت اصلی قرارداد و زیر نوع موردنظر را به‌عنوان مبنای شناسایی انتخاب کنید.

## 4) ورود اطلاعات دریافت/پرداخت از طریق اکسل

#### 4.1) فرمت صحیح ورود اطلاعات دریافت/پرداخت

•    **فیلد تاریخ:** روز/ماه/سال

•    **فیلد چک باکس:** true /false، بلی/خیر، yes/no، 0/1

•    **فیلد ساعت:** 00:00

•    **فیلد کاربر:** نام کاربری یا کلید کاربر

•    **شماره دریافت/پرداخت:** بر اساس قالب شماره‌گذاری آن نوع موجودیت 

•    **پروفایل مرتبط:** نام هویت یا شماره مشتری

•    **فیلد لیستی:** می‌بایست به‌ازای هر مقدار لیست، رکورد مربوطه در فایل اکسل تکرار گردد. همچنین در این حالت، اطلاعات فیلد رکورد آخر به همراه تمام مقادیر فیلد لیستی آن که در رکوردهای مربوطه وارد شده است، در سیستم وارد می‌گردد. مثال فیلد لیستی: لیست عدد، لیست متن

#### 4.2) نکات مربوط به ورود اطلاعات دریافت/پرداخت

•    در مرحله‌ی دوم می‌توانید یکی از فیلدهای شماره دریافت/پرداخت، فیلدهای اضافه‌ی (از نوع متن، عدد و شناسه خودکار) روی موجودیت اصلی دریافت/پرداخت و زیر نوع موردنظر را به‌عنوان مبنای شناسایی انتخاب کنید.

•    امکان ورود اطلاعات فیلد فاکتور مرتبط از طریق اکسل وجود ندارد.

#### 4.3) مجوزهای مربوط به ورود اطلاعات دریافت/پرداخت

## مجوز تعیین نوع دریافت/پرداخت: 

کاربر باید برای انتخاب نوع دریافت/پرداخت نقدی مجوز تعیین نوع دریافت/پرداخت نقدی، برای دریافت/پرداخت اعتباری مجوز تعیین نوع دریافت/پرداخت اعتباری و برای دریافت/پرداخت چکی مجوز تعیین نوع دریافت/پرداخت چکی را داشته باشد.
