# انواع فاکتور

## امکان تعریف فرمول برای فاکتورها به‌صورت پیشرفته از طریق اکسل

در این ورژن امکان تعریف فرمول برای فیلد قیمت کل و تعداد در فاکتورها از طریق اکسل اضافه شده است.
از قسمت شخصی‌سازی، مدیریت فاکتورها، بخش ویرایش فاکتور می‌توان فرمول محاسبه‌ای برای تعداد محصولات (مقدار) و قیمت کل تعریف کرد.
برای تعریف فرمول ابتدا باید "چک باکس " روش محاسبه بر اساس اکسل " فعال گردد و گزینه تنظیمات انتخاب شود.
در این بخش می‌بایست فایل اکسلی که شامل فرمول تعریف شده است، پیوست گردد. 

## ورودی‌ها:

در بخش کد فیلد، فیلدی را که مقدارش به‌عنوان ورودی به اکسل در نظر گرفته می‌شود، انتخاب می‌کنیم و در قسمت سلول نیز تعیین می‌کنیم مقدار فیلد انتخاب شده باید برای "کدام" یک از سلول‌های اکسل لحاظ شود. لازم به ذکر است در این حالت می‌توان از فیلدهای اضافه ردیف فاکتور به‌عنوان ورودی استفاده نمود. به‌علاوه، در محاسبه‌ی قیمت کل، فیلد تعداد و قیمت واحد نیز به‌عنوان ورودی قابل انتخاب هستند.

## خروجی:

سلول اکسلی که در آن فرمول موردنظر تعریف شده است باید انتخاب شود، این خروجی در فیلدی که فرمول‌نویسی برای آن انجام می‌شود (تعداد یا قیمت کل) نمایش داده می‌شود.

مثال: برای قیمت کل پیش‌فاکتور فرمول زیر در اکسل تعریف شده است.


![photo](https://raw.githubusercontent.com/1stco/PayamGostarDocs/master/releasenote/2.6.0/excel1.jpg)

اگر قیمت واحد سلول B1 اکسل و تعداد محصول سلول C1 در نظر گرفته شود و هر دو به‌عنوان ورودی باشند، طبق فرمول بالا درصورتی‌که مقدار قیمت واحد ضرب در تعداد بزرگ‌تر از 1000 باشد، این مقدار در 0.95 ضرب می‌شود و در خروجی که همان قیمت کل است نمایش داده می‌شود و در غیر این صورت اگر مقدار قیمت واحد ضرب در تعداد کوچک‌تر از 1000 باشد همان مقدار قیمت واحد ضرب در تعداد در قیمت کل نمایش داده می‌شود.
![photo](https://raw.githubusercontent.com/1stco/PayamGostarDocs/master/releasenote/2.6.0/excel2.jpg)


![photo](https://raw.githubusercontent.com/1stco/PayamGostarDocs/master/releasenote/2.6.0/excel3.jpg)

 
## تولتیپ و تغییر اندازه فیلد شماره

اندازه فیلد شماره در انواع فاکتورهای فروش و خرید به‌منظور نمایش هر چه مناسب‌تر شماره، بزرگ‌تر شده است و به‌علاوه، امکان تولتیپ نیز برای آن فراهم گردیده است. لازم به ذکر است درصورتی‌که شماره آیتم را تغییر دهیم، تولتیپ شماره قبلی را نشان می‌دهد و تولتیپ شماره جدید را نشان نمی‎دهد. 
