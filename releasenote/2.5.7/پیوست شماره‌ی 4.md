# پیوست شماره‌ی 4 

# فعالیت اجرای دستورات پایگاه داده

هدف از استفاده‌ی فعالیت اجرای دستورات پایگاه داده، انتقال اطلاعات مورد نیاز از پیام‌گستر به بانک‌های اطلاعاتی موردنظر و بلعکس، می باشد. این کار از طریق نوشتن کوئری در این فعالیت انجام می شود.

برای استفاده از این فعالیت از مسیر تنظیمات،شخصی سازی crm، نمای کلی، ویرایش چرخه کاری اقدام نمایید. در این بخش با انتخاب فعالیت جدید می توانید، از فعالیت اجرای دستورات پایگاه داده(SQL Activity) در فرآیند استفاده کنید.

![](//server/Public%20Space/Developers/h.abbasi/H.abbasi%20new/2.5.7/2.5.7.md/photo4.1.png)

در این فعالیت شما با انتخاب نوع پایگاه داده(در حال حاضر فقط SQL server  پشتیبانی می گردد) و تعریف رشته اتصال (اطلاعات مورد نیاز برای دسترسی به بانک اطلاعاتی) می توانید به بانک اطلاعاتی مورد نظر دسترسی داشته باشید.

برای نوشتن کوئری در این فعالیت، علاوه بر دستورات SQL می توان ازcustom Expression  که به صورت مجزا در فایل پیوست شماره 3 توضیح داده شده است، استفاده نمایید. 

> **نکته:** Custom Expression در حال حاضر فقط بر روی آیتم‌هایی از نوع فرم، هویت، وظیفه، درخواست پشتیبانی و انواع فاکتور، پیش فاکتور و فاکتورهای برگشت از خرید و فروش قابل استفاده می باشد. لذا به عنوان مثال، در صورتیکه می خواهید از این فعالیت در آیتم "تماس تلفنی"، برای مقداردهی فیلدهای همین موجودیت استفاده کنید، صرفا باید از دستورات SQL استفاده کنید.

> توسعه می‌شود برای استفاده از فعالیت sql  از ورژن 2017 به بالا sql استفاده شود.

## نحوه نوشتن Expression در این فعالیت:

Expression باید به صورت select @(Expression); نوشته شود.

با فعال کردن چک‌باکس "خروجی دارد" و انتخاب فیلد موردنظر در قسمت پارامتر خروجی می‌توانید اطلاعات مدنظر را از بانک اطلاعاتی دیگر یا بانک اطلاعاتی پیام‌گستر دریافت کرده و در این فیلد مشاهده کنید.

لازم به ذکر است در صورت عدم فعال بودن چک باکس "خروجی دارد"، فیلدی از آیتم جاری(تحت فرآیند) مقداردهی نمی شود و اطلاعات به آیتم دیگر در پیام‌گستر یا به بانک اطلاعاتی موردنظر مطابق کوئری تعریف شده، منتقل می‌شود. 

![](//server/Public%20Space/Developers/h.abbasi/H.abbasi%20new/2.5.7/2.5.7.md/photo4.2.png)

لیست فیلدهای پیش‌فرض موجودیت‌ها که امکان انتخاب آنها به عنوان پارامتر خروجی وجود دارد، به شرح زیر است:

**لیست فیلدهای اضافه‌ی قابل پشتیبانی جهت انتخاب در پارامتر خروجی:**

•	Html

•	پول

•	تاریخ شمسی

•	تاریخ میلادی

•	چک باکس

•	ساعت 

•	عدد

•	کاربر

•	گروه

•	لینک

•	متن 

•	شرکت/شخص

