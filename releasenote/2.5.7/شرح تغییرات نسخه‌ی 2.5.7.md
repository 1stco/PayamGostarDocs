# سوابق
## انواع فاکتور

### امکان تعریف فرمول برای فاکتورها به صورت پیشرفته از طریق اکسل
در این ورژن امکان تعریف فرمول برای فیلد قیمت کل و تعداد در فاکتورها از طریق اکسل اضافه شده است.
از قسمت شخصی سازی، مدیریت فاکتورها، بخش ویرایش فاکتور می‌توان فرمول محاسبه ای برای  تعداد محصولات (مقدار ) و قیمت کل تعریف کرد.
برای تعریف فرمول ابتدا باید "چک باکس " روش محاسبه بر اساس اکسل " فعال گردد و گزینه تنظیمات انتخاب شود.
در این بخش می بایست فایل اکسلی که شامل فرمول تعریف شده می‌باشد، پیوست گردد. 

#### ورودی‌ها:

در بخش کد فیلد، فیلدی را که مقدارش به عنوان ورودی به اکسل در نظر گرفته می شود، انتخاب می کنیم و در قسمت سلول نیز تعیین می کنیم مقدار فیلد انتخاب شده باید برای "کدام" یک از سلول های اکسل لحاظ شود. لازم به ذکر است در این حالت می توان از فیلدهای اضافه ردیف فاکتور به عنوان ورودی استفاده نمود. به علاوه، در محاسبه‌ی قیمت کل، فیلد تعداد و قیمت واحد نیز به عنوان ورودی قابل انتخاب می‌باشند.

#### خروجی:

سلول اکسلی که در آن فرمول موردنظر تعریف شده است باید انتخاب شود، این خروجی در فیلدی که فرمول نویسی برای آن انجام ‌می‌شود(تعداد یا قیمت کل) نمایش داده می‌شود.

مثال: برای قیمت کل پیش فاکتور فرمول زیر در اکسل تعریف شده است.


![excel](https://s4.uupload.ir/files/releas1_thjc.jpg)

اگر قیمت واحد سلول B1 اکسل و تعداد محصول سلول C1 درنظر گرفته شود و هر دو به عنوان ورودی باشند، طبق فرمول بالا در صورتیکه مقدار قیمت واحد ضرب در تعداد بزرگ تر از 1000 باشد، این مقدار در 0.95 ضرب می‌شود و در خروجی که همان قیمت کل است نمایش داده می‌شود و در غیر این صورت اگر مقدار قیمت واحد ضرب در تعداد کوچیک تر از 1000 باشد همان مقدار قیمت واحد ضرب در تعداد در قیمت کل نمایش داده می‌شود.
![excel2](https://s4.uupload.ir/files/release2_4lz0.jpg)


![excel3](https://s4.uupload.ir/files/releas3_aa22.jpg)

### تولتیپ و تغییر اندازه فیلد شماره

اندازه فیلد شماره در انواع فاکتورهای فروش و خرید به منظور نمایش هر چه مناسب تر شماره، بزرگ تر شده است و به علاوه، امکان تولتیپ نیز برای آن فراهم گردیده است.

## فرم‌

### امکان ورود و ویرایش اطلاعات فرم‌ها از طریق اکسل 
در این ورژن قابلیت ورود و ویرایش اطلاعات فرم‌ها از طریق اکسل به پیام‌گستر اضافه شده است.
برای مطالعه‌ی راهنمای ورود اطلاعات از طریق اکسل، در ادامه این مطلب، پیوست 2 را مراجعه کنید.

## قرارداد
### امکان ورود و ویرایش اطلاعات قراردادها از طریق اکسل
در این ورژن قابلیت ورود و ویرایش اطلاعات قراردادها از طریق اکسل به پیام‌گستر اضافه شده است.
برای مطالعه‌ی راهنمای ورود اطلاعات از طریق اکسل به بخش پیوست 2 مراجعه کنید.

### تولتیپ و تغییر اندازه فیلد شماره 
اندازه فیلد شماره قرارداد به منظور نمایش هر چه مناسب تر شماره، بزرگ تر شده است و به علاوه، امکان تولتیپ نیز برای آن فراهم گردیده است.
## دریافت/پرداخت
### امکان ورود و ویرایش اطلاعات دریافت/پرداخت از طریق اکسل
در این ورژن قابلیت ورود و ویرایش اطلاعات دریافت‌ها/پرداخت‌ها از طریق اکسل به پیام‌گستر اضافه شده است.
برای مطالعه‌ی راهنمای ورود اطلاعات از طریق اکسل به بخش پیوست 2 مراجعه کنید.

### تولتیپ و تغییر اندازه فیلد شماره 
اندازه فیلد شماره دریافت/پرداخت به منظور نمایش هر چه مناسب تر شماره، بزرگ تر شده است و به علاوه، امکان تولتیپ نیز برای آن فراهم گردیده است.
## قرارملاقات
### اضافه شدن پارامترهای زمان شروع و پایان در پیام‌های سیستمی 
در پیام سیستمی‌های لغو قرارملاقات، تغییر قرارملاقات یا یادآوری قرارملاقات پارامترهای تاریخ شروع قرارملاقات، تاریخ پایان قرارملاقات، زمان شروع قرارملاقات و زمان پایان قرارملاقات اضافه شده است. لازم به ذکر است پارامتر بازه‌ی زمانی همچنان در پیام‌های 
سیستمی قرارملاقات وجود دارد.
### فیلتر مدعوین قرار ملاقات
درصورتیکه در نظر داشته باشید در قسمت تقویم کاری من،  قرار ملاقات را برحسب دعوت شدگان فیلتر نمایید، اگر نوع دعوت شدگان(کاربر، مشتری و اطلاعات تماس) در فیلتر اعمال شده یکسان باشد، حتی اگر تنها یک فرد در نتیجه فیلتر موجود باشد، قرارملاقات مربوطه در نتایج جستجو در تقویم کاری نمایش داده خواهد شد و لزومی ندارد همه افراد انتخاب شده در نتیجه فیلتر وجود داشته باشند. ولی اگر نوع دعوت شدگان متفاوت باشد، یعنی یک فرد از انتخاب کاربر و یک فرد از انتخاب مشتری افزوده شده باشد، نتیجه فیلتر، قرارهایی را نمایش می دهد که هر دو فرد مورد نظر در آنها حضور داشته باشند. 
### بهبود عملکرد ویجت قرار ملاقات
- از این پس در ویجت قرارملاقات، صرفا قرارهای موجود در همان روز که موعد آنها(بر اساس ساعت شروع) نرسیده باشد، نمایش داده خواهند شد. به بیانی دیگر، قرار هایی که موعد آنها گذشته باشد، در این ویجت قابل مشاهده نخواهند بود.
- از این پس ترتیب نمایش قرارملاقات ها در ویجت مربوطه، به صورت صعودی بر اساس ساعت شروع آنها خواهد بود.

### ذخیره تنظیمات مشاهده‌ی تقویم در تقویم کاری من 
در این ورژن تنظیماتی که در تقویم کاری من برای مشاهده‌ی تقویم‌ها توسط کاربر اعمال می‌شود، ذخیره شده و با هر بار ورود به نرم‌افزار همان تنظیمات نمایش داده می‌شود.
لازم به ذکر است همانند قبل، پیش از اعمال تنظیمات اگر تعداد تقویم‌ها کم از 5 باشد، تمام تقویم‌ها به صورت پیش فرض فعال است و درصورتیکه تعداد تقویم‌ها بیش تر از 5 باشد، تمام آن‌ها غیرفعال است.

## تبلیغات

### افزایش تعداد ارقام فیلد هزینه‌ی برآوردی در فعالیت تبلیغاتی 

در فعالیت تبلیغاتی در بخش مدیریت کمپین‌ها تعداد ارقام فیلد هزینه‌‌ی برآوردی  از 10 رقم به 14 رقم افزایش یافته است.

## بانک اطلاعاتی

### بهبود عملکرد ورود و ویرایش اطلاعات هویت‌ها از طریق اکسل 

در این ورژن عملکرد ورود و ویرایش اطلاعات هویت‌ها از طریق اکسل تغییر کرده و بهبود یافته است.
برای مطالعه‌ی راهنمای ورود اطلاعات از طریق اکسل به بخش پیوست 1 مراجعه کنید.

### بهبود عملکرد تبدیل نوع هویت 

در حال حاضر با استفاده از دکمه مربوطه در هویت یا کلیک راست، امکان
تبدیل انواع هویت به شکل زیر وجود دارد : 

• تبدیل مخاطب حقوقی به مخاطب حقیقی و حقوقی

• تبدیل مخاطب حقیقی به مخاطب حقیقی و حقوقی

• تبدیل سرنخ حقیقی به سرنخ حقیقی و حقوقی

• تبدیل سرنخ حقوقی به سرنخ حقیقی و حقوقی

## گزارش‌ساز

### اضافه شدن جدول های جدید به بخش کوئری ساز
جدول های جدید به شرح ذیل به بخش کوئری ساز اضافه شده است.


![123](https://user-images.githubusercontent.com/85984198/125412227-5449bfdc-e03b-433e-8ecf-25956c22118a.png)

### امکان ساخت گزارش از ردیف محصول فرصت 
در گزارش ساز امکان استفاده از دیتاست ردیف محصولات فرصت در دسترس قرار گرفته شده است.
### امکان ساخت گزارش از ردیف محصول پیش فاکتور

در گزارش ساز امکان استفاده از دیتاست ردیف محصولات پیش فاکتور در دسترس قرار گرفته شده است.
### امکان کپی کردن گزارش
در لیست گزارشات، دکمه ای با عنوان "کپی" اضافه شده است که با انتخاب آن، گزارش جدیدی با عنوان گزارش انتخابی، در همان دسته بندی ایجاد خواهد شد. علاوه بر ادمین و سازنده گزارش، کاربران دارای مجوز مدیریت گزارش¬های ساخته شده یا مجوز طراحی گزارش، دسترسی کپی گزارشات را دارا می¬باشند.
### الزامی شدن order by در کوئری ساز 
برای استفاده از کوئری ساز استفاده از دستور order by  الزامی شده است.
### اضافه شدن انواع پارامترهای جدید برای فیلتر 
قبل از ذخیره گزارش، می بایست نوع پارامتر تعریف شده جهت انجام فیلتر تعیین شود. حال در این ورژن به این لیست، پارامترهایی به شرح زیر اضافه شده است:
لیست انبار و گروه انبار، لیست محصولات و گروه محصولات، علت موفقیت فرصت، سیستم تلفنی، دسته بندی مشتریان، بازه‌ی زمانی با تفکیک زمانی، بازه ی زمانی، زیر نوع فاکتور فروش و حواله انبار، زیرنوع فاکتور خرید و رسید انبار، زیر نوع حواله/رسید انبار و فاکتور فروش، زیرنوع حواله/رسید انبار و فاکتور خرید، انبار، وضعیت انبار، نوع ارتباط، فیلتر پیشرفته مخاطبان، نوع فعالیت، نوع قرارداد، نوع فرصت، کمپین، نوع تماس، ترتیب بندی تماس و منبع فرصت
### امکان تغییر نام پارامتر در فیلتر گزارش ساز 
در ورژن قبل، هنگام تعریف پارامتر فیلتر، پس از ذخیره شدن، امکان تغییر نام پارامتر به فارسی وجود نداشت. در ورژن جدید، در مرحله سوم گزارش ساز، می توانید از طریق آیکون کنار نام پارامتر، نام پارامتر را به زبان های فارسی و انگلیسی برای نمایش در گزارش تغییر دهید.

![EXCEL5](https://s4.uupload.ir/files/excel5_mzn0.jpg)

## جستجوی آیتم‌ها
### اضافه شدن امکان فیلتر به صورت بازه‌ای برای فیلدهای پول و عدد
فیلترهایی که براساس فیلدهای از نوع "عدد" و "پول "می‌باشند، مانند فیلدهای از نوع "تاریخ" به فیلترهای بازه‌ای تغییر کرده اند. برای نمونه فیلتر فیلد از نوع عدد به صورت "عدد از" و "عدد تا " تغییر کرده است.
### اضافه شدن امکان فیلتر بر اساس مرحله
از این پس می توان در صورتیکه برای موجودیتی مرحله تعریف شده باشد، براساس آن در لیست موجودیت ها و تاریخچه CRM، فیلتر اعمال نمود.
## مرحله بندی 
### اصلاح نمایش کامل مراحل فرصت در نمای کانبان لیست فرصت‌ها 
در لیست فرصت‌ها در نمای کانبان، مراحل فرصت به صورت کامل نمایش داده نمی‌شد، به این معنی که با اسکرول مراحل بعدی نمایش داده نشده و بازهم مراحل اول قابل مشاهده بود، در حال حاضر این مشکل برطرف گردیده است.
### عدم امکان تعریف مرحله در تراکنش های انبار
امکان تعریف مرحله برای تراکنش‌های انبار وجود ندارد و در شخصی سازی تراکنش‌ها این قابلیت حذف شده است.

## تنظیمات 
### اضافه شدن تنظیمات ارز به نرم‌افزار
در بخش تنظیمات کلی نرم‌افزار، تنظیمات مرتبط با ارز اضافه شده است که در حال حاضر تنها ارز قابل پشتیبانی ریال می‌باشد و امکان تعیین تعداد اعشار آن وجود دارد.
تعداد اعشار ارز ریال می‌تواند از 0 تا 2 رقم باشد.
تعداد اعشار در حالتیکه قیمت گذاری در لیست قیمت بر اساس رقم باشد، از این تنظیمات پیروی می کند، به علاوه فیلدهای اضافه از نوع پول نیز به همین شکل می باشند.
## لیست قیمت 
### دریافت خروجی، ورود و ویرایش اطلاعات لیست قیمت‌ها از طریق اکسل
در این ورژن قابلیت دریافت خروجی از لیست قیمت‌ها و همچنین امکان ورود و ویرایش اطلاعات لیست قیمت‌ها از طریق اکسل به پیام‌گستر اضافه شده است.
برای مطالعه‌ی راهنمای ورود اطلاعات از طریق اکسل به بخش پیوست 3 مراجعه کنید.
### امکان تعریف سیاست قیمت‌گذاری محصول به صورت اعشاری
در بخش مدیریت لیست قیمت‌ها امکان تعریف سیاست قیمت‌گذاری برای محصول براساس رقم و درصد به صورت اعشاری اضافه شده است.
تعداد اعشار در تعریف سیاست قیمت‌گذاری درصدی تا دو رقم اعشار می‌باشد و در صورتی که سیاست قیمت‌گذاری براساس رقم باشد، تعداد اعشار قابل تعریف در این بخش طبق تنظیمات اعمال شده در تنظیمات کلی،  قسمت ارز می‌باشد.
### امکان افزودن همه محصولات
در این ورژن امکانی فراهم شده است که می توان از طریق آن در لیست قیمت همه محصولات را تنها با یک بار انتخاب، به لیست قیمت اضافه نمود.
## شخصی سازی
### امکان تعریف مقدار منفی برای فیلد از نوع پول و لیستی پول 
امکان تعریف مقدار منفی برای فیلدهای از نوع پول و لیستی پول در این ورژن اضافه شده است.
### امکان حذف نوع درخواست ایجاد شده در شخصی سازی 
در ورژن قبل در صورت ایجادنوع درخواست جدید در شخصی سازی، امکان حذف آن وجود نداشت که در این ورژن این مشکل برطرف گردیده است.
### امکان استفاده از فیلد لیست کشویی در فیلد محاسباتی 
در ورژن جدید، از فیلد لیست کشویی می توان به عنوان ورودی فیلد محاسباتی استفاده کرد.
### صحت سنجی مقادیر فیلدهای از نوع عبارت 
در صورت اضافه کردن یک فیلد از نوع عبارت به موجودیت های نرم افزار و مقدار دهی نامعتبر آن، در قسمت های مختلف نرم افزار از جمله ارسال پیامک و پیش نمایش با خطا مواجه می¬شدیم که این خطا با اعتبار سنجی مقادیر این عبارت در هنگام افزودن آن مرتفع شد. به منظور آشنایی با استاندارد نوشتن Expression می توانید از طریق لینک زیر اقدام نمایید:

https://docs.microsoft.com/en-us/dotnet/api/system.data.datacolumn.expression?view=net-5.0

## قالب چاپ(پیش نمایش)

### امکان اشتراک گذاری قالب چاپ آیتم‌ها
در این ورژن امکان اشتراک گذاری قالب چاپ (پیش نمایش) آیتم ها از طریق ایجاد لینک اشتراک گذاری فراهم شده است. 
برای این منظور در هر آیتم، کلیدی با عنوان ایجاد لینک اشتراک گذاری وجود دارد که با کلیک بر روی آن در صورتیکه آیتم دارای قالب چاپ باشد، لینک اشتراک گذاری آن قالب ایجاد می‌گردد.
با کلیک روی این لینک، امکان مشاهده ی قالب چاپ(پیش نمایش) آیتم موردنظر، با فرمت PDF میسر می‌باشد. به علاوه، می توان از طریق کلید مربوطه، لینک آن را جهت نمایش در مرورگر کپی نمود.
در نظر داشته باشید، لینک ایجاد شده در این قسمت مدت انقضا دارد و تا 2 ماه قابل استفاده است و بعد از اتمام مدت انقضا، آن لینک اعتباری ندارد و می بایست لینک اشتراک گذاری جدید ایجاد کنید.
لازم به ذکر است، امکان استفاده از پارامتر هوشمند لینک اشتراک گذاری برای استفاده در پیام های سیستمی و پیش نمایش وجود دارد.
همچنین فعالیت ایجاد لینک اشتراک گذاری به چرخه کاری اضافه شده است که با استفاده از آن فعالیت، لینک اشتراک گذاری به صورت خودکار ایجاد می گردد. 

### پارامترهوشمند هویت در قالب پیش نمایش تراکنش‌های انبار
امکان استفاده از پارامترهای هوشمند تحویل گیرنده و تحویل دهنده در قالب پیش نمایش حواله و رسید انبار وجود دارد.
## چرخه‌ی کاری

### قابلیت استفاده از فیلدهای رسید و حواله انبار در فعالیت ارسال فکس 
در فعالیت ارسال فکس در صورت انتخاب گزینه‌ی Send This Field امکان انتخاب فیلد رسید و حواله انبار فراهم شده است.

### اضافه شدن فعالیت اجرای دستورات پایگاه داده
با استفاده از فعالیت اجرای دستورات پایگاه داده می‎توان از طریق تعریف Expression تبادل اطلاعات را بین پیام‌گستر و دیتابیس‌های دیگری انجام داد. لازم به ذکر است برای استفاده از این فعالیت، می-بایست ماژول "مدیریت فرآیند کسب و کار پیشرفته " فعال باشد.

### امکان استفاده از Expression در فعالیت تخصیص مقدار و چندشرطی
با اضافه شدن قابلیت  تعریف Expression در فعالیت‌های تخصیص مقدار و چندشرطی می‌توان اطلاعات  را از دیتابیس‌های دیگر دریافت کرده و در  خروجی موردنظر مشاهده کرد. لازم به ذکر است برای استفاده از این قابلیت،می¬بایست ماژول "مدیریت فرآیند کسب و کار پیشرفته " فعال باشد.

### اضافه شدن فعالیت ایجاد لینک اشتراک گذاری  
فعالیتی با نام  ایجاد لینک اشتراک گذاری به چرخه کاری فرآیند اضافه شده است. این فعالیت،  لینک مربوط به قالب چاپ (پیش نمایش) آیتم تحت چرخه را به صورت خودکار ایجاد می کند تا برای اشتراک گذاری استفاده شود. 
با استفاده از این لینک در مرورگر، قالب چاپ(پیش نمایش) آیتم مورد نظر قابل مشاهده است و امکان خروجی گرفتن از آن با فرمت PDF وجود دارد.

## دسترسی‌ها

### اصلاح عملکرد سطح دسترسی ویرایش مسئول در هویت
مجوزهای مورد نیاز جهت ویرایش مسئول فروش، پشتیبانی و متفرقه‌ی هویت:

1)کاربر با مجوز مدیر پشتیبانی می‌تواند مسئول پشتیبانی،  با مجوز مدیر فروش می‌تواند مسئول فروش و با مجوز مدیر بانک اطلاعاتی و مدیر سیستم می‌تواند هر سه مسئول را ویرایش کند.

2)درصورت فعال بودن چک باکس " اجازه تخصیص کارشناس پروفایل به کاربران دیگر " در تنظیمات کلی، بخش امنیتی، هر کاربر که به عنوان مسئول هویت تعیین شده باشد می‌تواند برای خود جانشین تعیین کند.

3)کاربری که اولین بار  فیلد های مسئول فروش،مسئول پشتیبانی و متفرقه هویت را مشخص کرده باشد، می‌تواند این سه مسئول را ویرایش کند.
در ورژن قبل هنگامی که کاربر ویرایشی روی هویت انجام می‌داد، بدون داشتن هیچ کدام از مجوزهای ذکرشده این فیلدها را به صورت فعال مشاهده می‌کرد و امکان ویرایش این سه مسئول را داشت. در این ورژن این مشکل برطرف گردیده است و کاربر تنها در صورت داشتن این مجوزها امکان ویرایش سه مسئول را دارد.

### اصلاح عملکرد مجوز جستجوی پیشرفته 
مجوز جستجوی پیشرفته در ورژن قبل مشکل داشت، به این معنی که کاربر با داشتن این مجوز در صفحه‌ی جستجوی پیشرفته با کلیک بر روی فیلتر دسترسی سریع دیگر امکان استفاده از سایر فیلترها را نداشت و خطا نمایش داده می‌شد که این مشکل برطرف شده است.
## انبارداری
### بهبود مجوز های انبارداری
در این ورژن، مجوزهای انبارداری به شرح ذیل بهبود یافته اند:

•	از این پس، مدیر سیستم و کاربر دارنده مجوز "مدیریت انبارداری" در همه انبارها مجوز "مدیریت" خواهند داشت.

•	کاربر در گزارش موجودی انبار و کاردکس کالا، موجودی و تراکنش های انبارهایی را مشاهده می-کند که در آنها مجوز "مشاهده گزارش" را داشته باشد.

•	کاربر دارنده مجوز "مشاهده لیست تراکنش اقلام"، در لیست تراکنش های انبار، تراکنش هایی را مشاهده می کند که بر روی نوع آنها مجوز "مشاهده آیتم" یا "مشاهده لیست" دارد.

•	در ورژن قبل، در صورت داشتن مجوز صدور حواله در انبار، دکمه انتقال بین انباری نمایش داده می شد که در حال حاضر، کاربر باید مجوز صدور رسید در حداقل یکی از انبارها را نیز داشته باشد تا بتواند این دکمه را مشاهده کند.  به علاوه، به منظور انجام انتقال بین انباری، انبار مبدا، انبار فعلی خواهد بود و در لیست انبارهای مقصد نیز انبارهایی نمایش داده می شود که کاربر در آنها مجوز صدور رسید داشته باشد. به علاوه در قسمت "نوع حواله مبدا" و "نوع رسید مقصد" نیز انواع موجودیتی نمایش داده می شود که کاربر بر روی آنها مجوز "ذخیره اولیه" دارد.

•	از این ورژن، کاربر به منظور ویرایش تراکنش های انبار می بایست دو مجوز "ویرایش آیتم" در آن نوع موجودیت و "ویرایش تراکنش موقت" در آن انبار را دارا باشد. به علاوه، در صورتیکه تراکنش تایید شده باشد، به مجوز های "ویرایش پس از تایید" در نوع موجودیت و "ویرایش تراکنش تایید شده" در آن انبار نیاز می¬باشد.

•	در ورژن قبل، کاربر با داشتن مجوز "ویرایش آیتم" می توانست نسبت به قیمت گذاری تراکنش ها اقدام کند. از این نسخه کاربر می¬بایست در آن انبار مجوز "قیمت گذاری تراکنش" نیز داشته باشد.

•	از این پس، به منظور تایید تراکنش های انبار، کاربر میبایست هر دو مجوز "تایید/رد آیتم" در نوع موجودیت و مجوز "تایید تراکنش" در انبار مربوطه را داشته باشد.

•	عملکرد فیلدهای آیتم سی آر ام از نوع حواله و رسید انبار نیز بدین ترتیب می باشد:

•	به منظور ایجاد حواله/رسید انبار جدید، کاربر باید حداقل روی یک نوع موجودیت و یک انبار مجوز ذخیره و صدور آیتم داشته باشد.

•	به منظور انتخاب یک حواله/رسید جدید، کاربر آیتم هایی را مشاهده می کند که روی آنها مجوز "مشاهده آیتم" یا "مشاهده لیست" دارد و در انبار ثبت شده نیز مجوز "مشاهده لیست تراکنش اقلام" داشته باشد.
## نظرات
### تغییر در تنظیمات ارسال نظر با Enter 
در این نسخه، تنظیمات ارسال نظر با Enter حذف شده است و با زدن کلید Enter، نشانگر مکان نما به خط بعدی منتقل می شود. برای ارسال پیام از طریق کیبورد، می توانید از کلیدهای ترکیبی Enter + Ctrl استفاده کنید.
## دریافت خروجی اکسل
### نمایش فیلد اضافه لیستی و فیلد لیستی سیستمی در خروجی اکسل
در ورژن جدید، به هنگام خروجی گرفتن اکسل از آیتم ها، قابلیت نمایش فیلد های لیستی از نوع لیست محصول، لیست متن، لیست عدد، لیست مبلغ، لیست لینک، لیست کاربر، لیست مشتری، لیست سمت، لیست دپارتمان، لیست تاریخ شمسی و میلادی در فایل اکسل اضافه شده است. همچنین، هنگام خروجی گرفتن از هویت ها، امکان نمایش فیلدهای لیستی سیستمی آدرس، انواع تلفن (تلفن، موبایل، فکس، تلفکس) نیز در اکسل وجود دارد. به علاوه، امکان نمایش ردیف های محصول در فایل اکسل، هنگام خروجی گرفتن از فاکتور و پیش فاکتور نیز میسر می‌باشد.
بدین منظور، درصورتیکه که در یک آیتم بیش از یک فیلد لیستی داشته باشید، هنگام خروجی گرفتن از آن، صفحه ای نمایش داده می‌شود که می توان از این طریق فیلد لیستی موردنظر جهت نمایش در خروجی اکسل را انتخاب نمود. لازم به ذکر است در هر بار خروجی گرفتن تنها می‌بایست یک مورد انتخاب گردد. نحوه نمایش مقادیر فیلد لیستی در فرمت اکسل نیز به این صورت می‌باشد که به ازای هر تعداد مقادیر لیستی، رکوردی در ردیف اکسل ایجاد خواهد شد که مقادیر فیلد لیستی در آن نمایش داده می¬شود.
توجه: در نظر داشته باشید برای نمایش فیلد اضافه از نوع لیستی در هویت ها، می بایست در بانک اطلاعاتی زیرنوع هویت مشخص گردد تا فیلد لیستی مربوطه، هنگام خروجی گرفتن قابل انتخاب باشد.
 توجه شود درصورت انتخاب گزینه "هیچ کدام" به هنگام دریافت خروجی اکسل، فایل مربوطه به صورت سابق و بدون اضافه کردن فیلدهای لیستی خواهد بود. در نظر داشته باشید، به هنگام اخذ خروجی از هویت ها در صورت انتخاب گزینه هیچ‌کدام، مقادیر فیلدهای لیستی سیستمی در یک سلول، در کنارهم قرار گرفته و با کاما ازهم جدا می شوند.
همچنین امکان افزودن فیلد های اضافه لیستی، جهت انتخاب برای نمایش در لیست نیز در این ورژن اضافه شده است. بدین منظور درصورتیکه تنظیمات نمایش در لیست این نوع فیلد های لیستی را فعال کنید، می توانید در نمای Grid موجودیت های آن آیتم، در ستون مربوطه، بر روی "مشاهده" کلیک کنید و مقادیر آن فیلد لیستی را به صورت پاپ آپ مشاهده کنید.
توجه: در نظر داشته باشید، امکان نمایش فیلدهای لیستی در خلاصه و نمایش به صورت کانبان وجود ندارد.

## پیوست شماره 1 

### (ورود اطلاعات هویت از طریق اکسل)
ورود اطلاعات هویت‌ها از طریق اکسل در ورژن جدید به شکل جدید انجام می شود که در این راهنما مراحل ورود اطلاعات، نکات و فرمت صحیح اطلاعات برای ورود توضیح داده شده است.
#### 1)	فرمت صحیح ورود اطلاعات از طریق اکسل

•	فیلد تاریخ: روز/ماه/سال

•فیلد چک باکس: true /false، بلی/خیر، yes/no، 0/1

•	فیلد کاربر: نام کاربری یا کلید کاربر

•	فیلد رنگ:  نام رنگ
•	
•	شماره مشتری: براساس قالب شماره گذاری آن نوع موجودیت

•	فیلد جنسیت: مرد/ زن، female /male و 1/ 2 (1: مرد، 2: زن)

•	فیلدهای مربوط به تلفن: "نوع تلفن" )تکمیل با مقادیر تلفن،
موبایل، فکس و تلفکس)، "شماره تلفن"، "الی"، "داخلی"، "توضیحات" و "پیش‌فرض" (تکمیل با مقادیر true/false،yes/no،1/0)

•	فیلدهای مربوط به آدرس: "نوع آدرس"(نشانی)، "منطقه"، "صندوق پستی"، "کد پستی"، "آدرس"، "کشور، استان و شهر"( ورود هر 3 فیلد کشور، استان و شهر به صورت همزمان) و "پیش فرض"(تکمیل با مقدار true/false)

•	فیلد‌های لیستی: 

همانطور که می دانید فیلد لیستی فیلدی ست که  این امکان را به شما می دهد که بیش از یک مقدار به فیلد مورد نظرتان اختصاص دهید. در واقع از این طریق، لیستی از مقادیر مرتبط با فیلد در آیتم ذخیره می شود. مثال فیلد لیستی: لیست عدد، لیست متن، اطلاعات تماس و آدرس های هویت

ورود این نوع فیلد در هویت ها به دو صورت به شرح ذیل امکان پذیر است:

##### ورود مقادیر به صورت یکپارچه : 
 
 در این روش برای اضافه کردن چند شماره تماس یا چند آدرس برای یک هویت، بایستی شماره تماس‌ها و آدرس‌‎ها با کاراکتر ";" از یک دیگر جدا شوند.(این روش تنها برای ورود اطلاعات فیلدهای لیستی شماره تماس‌ها شامل تلفن، موبایل، فکس، تلفکس و آدرس‌ها کاربرد دارد.)
 درنظر داشته باشید که در این روش اولین شماره و اولین آدرس به عنوان پیش فرض خواهند بود. همچنین در این حالت فقط می توان "شماره تلفن" وارد کرد و در صورت نیاز به ورود "داخلی و الی" باید از ورود مقادیر به صورت جداگانه در ردیف‌های اکسل استفاده نمود.
##### ورود مقادیر به صورت جداگانه در ردیف‌های اکسل:
 
 می بایست به ازای هر مقدار لیست، رکورد مربوطه در فایل اکسل تکرار گردد. همچنین در این حالت، اطلاعات فیلد رکورد آخر به همراه تمام مقادیر فیلد لیستی آن که در رکوردهای مربوطه وارد شده است، در سیستم وارد می‌گردد. 
#### 2)	مراحل ورود اطلاعات از طریق اکسل 
##### مرحله اول(بارگذاری فایل)
در گام اول، نوع و زیر نوع آیتم انتخاب شده نمایش داده می‌شود که می‌توان آن را ویرایش کرد.
در این مرحله می‌توانید فایل اکسل نمونه‌ای را دانلود کنید، این فایل شامل تمامی فیلدهای نوع آیتم انتخاب شده می‌باشد که با وارد کردن اطلاعات خود در فایل نمونه و ایمپورت آن می‌توانید ورود اطلاعات از طریق اکسل را با فرمت صحیح انجام دهید.

نکته : فیلدهای اضافه از نوع Html، برچسب، تصویر، رنگ، فایل، کمپین، فیلدهای لیستی و فیلد آیتم‌های crm (جز فیلد شرکت/شخص) در فایل نمونه قابل مشاهده نمی‌باشند.
در این مرحله فایل اکسل خود را انتخاب یا از طریق drag & drop آپلود کنید، با کلیک بر روی مرحله بعد وارد مرحله دوم شوید.

##### مرحله دوم(تنظیمات)

1) افزودن اطلاعات جدید: با انتخاب این روش آیتم های موجود در فایل اکسل به نرم‌افزار اضافه می‌شوند.
در این مرحله می‌توانید یکی از فیلدهای شماره مشتری، تلفن، موبایل و ایمیل را به عنوان مبنای شناسایی انتخاب کنید. تا براساس آن جستجوی تکراری بودن انجام شود، در صورت تکراری نبودن مقدار مبنای انتخاب شده، آن آیتم به نر‍‌م‌افزار اضافه می‌شود.
همچنین در این روش امکان انتخاب گزینه‌ی هیچکدام به عنوان مبنا وجود دارد، در صورت انتخاب هیچکدام به عنوان مبنای شناسایی، تمامی هویت‌های موجود در اکسل به بانک اطلاعاتی اضافه خواهد شد و بررسی تکراری بودن اطلاعات تنها از طریق تنظیمات اعمال شده در تنظیمات کلی بخش سیستم انجام خواهد شد. 

![ECXEL7](https://user-images.githubusercontent.com/85984198/125398799-0234a880-e3c5-11eb-99ea-9b009270165a.jpg)

2) ویرایش اطلاعات موجود: در این روش براساس فیلدی که به عنوان مبنا انتخاب شده است، جستجوی تکراری بودن انجام می‌شود و در صورت تکراری بودن مقدار مبنای انتخاب شده، آیتم دارای این اطلاعات ویرایش می شود.
با انتخاب چک باکس " فقط فیلد های خالی پر شوند " تنها فیلدهای خالی آیتم در حال ویرایش مقداردهی می‌شوند.

3) افزودن و ویرایش: در این روش براساس فیلد مبنای انتخاب شده جستجو انجام میشود، در صورت تکراری بودن اطلاعات آن فیلد، آیتم دارای این اطلاعات ویرایش می‌شود و در صورت تکراری نبودن، آیتم جدید به نرم‌افزار اضافه می شود.
با انتخاب چک باکس " فقط فیلد های خالی پر شوند " تنها فیلدهای خالی آیتم در حال ویرایش مقدار دهی می‌شوند.

##### روش ورود فیلدهای لیستی سیستمی : 
همانطور که در بخش "فرمت صحیح ورود اطلاعات از طریق اکسل" توضیح داده شد، با فعال کردن چک باکس "ورود مقادیر به صورت یکپارچه"  امکان ورود اطلاعات فیلدهای لیستی شماره تماس‌ها و آدرس‌ها به صورت یکپارچه با استفاده از کاراکتر ";" فراهم می‌گردد.

![ECXEL8](https://user-images.githubusercontent.com/85984198/125400494-2f825600-e3c7-11eb-9d88-ef6677985bfc.jpg)

لازم به ذکر است در صورت استفاده از این روش دیگر فیلدهای تلفن، موبایل، فکس، تلفکس و آدرس به عنوان فیلدهای لیستی درنظر گرفته نخواهند شد و در گام سوم در فیلدهای ماشین نمایش داده می‌شوند.
همچنین در این روش نیز اگر فیلد تلفن یا موبایل به عنوان مبنا انتخاب شده باشد، باید ستونی با نام تلفن پیش‌فرض یا موبایل پیش‌فرض در اکسل تعریف 
گردد  تا مبنای جستجوی تکراری ها قرار گیرد.

![ECXEL9](https://user-images.githubusercontent.com/85984198/125400970-cc44f380-e3c7-11eb-9115-ec273f8f8bab.jpg)

توجه شود که در صورت عدم فعالسازی چک باکس " ورود مقادیر به صورت یکپارچه "،  ورود اطلاعات فیلدهای شماره تماس‌ها و آدرس‌ها باید از روش "ورود مقادیر به صورت جداگانه در ردیف‌های اکسل" انجام شود.

##### مرحله سوم(نگاشت فیلدها)

در مرحله سوم سرستون‌های فایل اکسل در بخش فیلدهای شما نمایش داده می شود و فیلدهای موجود در آیتم در بخش فیلدهای ماشین شما نمایش داده می شود.
با drag & drop فیلدها، امکان نگاشت آنها با فیلد های سیستم وجود دارد.
فیلدهای هم نام به صورت خودکار نگاشت می‌شوند و همچنین با انتخاب "نگاشت فیلدهای هم نام" امکان نگاشت وجود دارد.
شما می‌توانید نگاشت مورد نظر خود (به جز نگاشت فیلدهای لیستی) را با استفاده از "ذخیره نگاشت" ذخیره کنید و درصورت نیاز از لیست نگاشت‌ها آن را انتخاب کنید.
در لیست نگاشت های من امکان ویرایش یا حذف نگاشت ذخیره شده وجود دارد.
لازم به ذکر است امکان نگاشت "یک" فیلد لیستی در هر بار ورود اطلاعات وجود دارد، برای این کار فیلد لیستی مورد نظر را از لیست انتخاب کرده و نگاشت فیلد را انجام دهید، اما در صورت ورود مقادیر فیلدهای لیستی به صورت یکپارچه، در این مرحله دیگر امکان انتخاب آن‌ها از لیست وجود ندارد بلکه این فیلدها، در بخش فیلدهای ماشین قابل مشاهده می‌باشند.

نکته: در صورتیکه فیلدی در سیستم دارای مقدار پیش فرض باشد در این بخش قابل مشاهده و ویرایش می‌باشد، همچنین می‌توانید برای فیلدها در این بخش مقدار پیش‌فرض تعریف کنید تا در صورت خالی بودن این فیلد در فایل اکسل، در نرم‌افزار فیلد با این مقدار پیش‌فرض، مقداردهی شوند.

##### مرحله چهارم(شروع بارگذاری)
در صورت مشکل در بارگذاری اطلاعات، خطای مرتبط در این گام نمایش داده می‌شود و فایل اکسلی شامل آیتم‌های دارای خطا قابل دریافت می‌باشد، که پس از اصلاح خطاها بارگذاری مجدد فایل انجام شود.
در منوی گزارش‌ها، بخش وضعیت عملیات انبوه می‌توان نتایج ورود اطلاعات را مشاهده کرد، همچنین در صورت بروز خطا، می توان از این بخش فایل اکسلی شامل آیتم‌های دارای خطا و علت خطای رخ داده دریافت نمود.

#### 3)	نکات مربوط به ورود اطلاعات هویت از طریق اکسل
•	امکان ورود اطلاعات فیلدهای از نوع فایل، تصویر، html، کمپین، برچسب، لیست مرتبط، فیلد آیتم‌های سی آر ام (جز فیلد شخص/شرکت)، فیلد اضافه از نوع رنگ، فیلد لیستی از نوع فایل، فیلد لیستی از نوع کاربر/گروه و فیلد لیستی آیتم سی آر ام از طریق اکسل وجود ندارد.

•	در صورت انتخاب گزینه‌ی "هیچکدام" در قسمت مبنا، امکان افزودن فیلد لیستی وجود ندارد. زیرا مبنایی برای شناسایی هویت انتخاب نشده است، به همین دلیل با انتخاب هیچ کدام، در گام دوم، گزینه "ورود مقادیر به صورت یکپارچه" برای ورود فیلدهای لیستی شماره تماس‌ها و آدرس‌ها به صورت خودکار فعال می‌گردد. 

•	برای فیلدی که به عنوان مبنا انتخاب شده است و فیلدهای اجباری آن آیتم، می بایست حتما نگاشت انجام شود و در فایل اکسل مقدار دهی هم شده باشند، در غیر این صورت، روند با خظا رو به رو می¬شود.

•	اگر جلوگیری از ثبت اطلاعات تکراری در تنظیمات کلی انجام شده باشد (برای مثال جلوگیری از ثبت تلفن تکراری) در هنگام ورود اطلاعات از طریق اکسل علاوه بر فیلد مبنا، این اطلاعات هم بررسی می‌گردد و در صورت تکراری بودن، ورود اطلاعات انجام نمی‌شود.
	هنگامیکه ایمیل، تلفن، موبایل یا شماره مشتری به عنوان مبنا انتخاب شوند، باید در اکسل نام آن‌ها به صورت ایمیل پیش فرض، تلفن پیش فرض، موبایل پیش فرض و شماره مشتری باشد.

•	در حالتیکه می خواهید یک یا چند تلفن را به صورت کامل(الی و ...) وارد نمایید، باید از فیلد لیستی تلفن استفاده کنید، در این حالت، اگر فیلد مبنا را تلفن قرار دهید، نیاز است یکی از شماره تلفن ها را هم در ستون "تلفن پیش فرض" برای همه ردیف های مربوط به این هویت ثبت نمایید، تا مبنای جستجو و شناسایی هویت قرار گیرد. این موارد برای موبایل نیز صدق می کند.

![EXCEL10](https://user-images.githubusercontent.com/85984198/125401686-b97eee80-e3c8-11eb-8578-abceb54d618d.jpg)

•	با توجه به این که اطلاعات کشور، استان و شهر یک لیست مرتبط و براساس اطلاعات وارد شده در قسمت مدیریت کشورها، استان‌ها و شهرها می‌باشند، برای ورود اطلاعات باید هر سه بطور همزمان در اکسل وارد شوند، همچنین در صورت عدم وجود اطلاعات تعریف شده، این اطلاعات به مدیریت کشور، استان و شهر اضافه می‌شود.

•	فیلدهایی از نوع لیست کشویی پیش‌فرض (فیلدهای موجود در مدیریت آیتم‌های سیستم) مانند نحوه آشنایی باید مطابق مقادیر موجود در نرم‌افزار مقدار دهی شوند، همچنین اگر در این فیلدها دو مقدار همنام وجود داشته باشد، هنگام بارگذاری اطلاعات اگر این مقدار همنام در اکسل تعریف شده باشد، آن فیلد در نرم‌افزار مقداردهی نمی‌شود و خطا می‌دهد.

•	در صورت انتخاب هویت از نوع حقوقی، در مرحله‌ی دوم امکان انتخاب نوع هویت حقیقی برای ورود اطلاعات مدیر(نام، نام خانوادگی، جنسیت، موبایل و کد ملی) وجود دارد. در هنگام ویرایش نیز، اگر هویت دارای مدیر بود تنها نام، نام خانوادگی و کد ملی مدیر قبلی با اطلاعات مدیر جدید ویرایش می‌شود.

•	در هنگام ویرایش، باید زیر نوع آیتم در حال ویرایش و زیر نوع آیتم انتخاب شده در گام اول یکسان باشد، در غیر این صورت بارگذاری انجام نمی‌شود.

•	در حالت ویرایش، اگر براساس مبنای انتخاب شده، چندین آیتم در نرم‌افزار وجود داشته باشد و هیچ فیلد لیستی نگاشت نشده باشد، هیچکدام از آیتم‌ها ویرایش نمی‌شوند.

•	در زمان ویرایش، مقادیر لیستی جایگزین مقادیر قبلی می‌شوند، بنابراین در صورتیکه نیاز است مقادیر جدید اضافه شوند، بایستی مقادیر قبلی نیز در اکسل تکرار گردند و در صورت عدم تکرار مقادیر قبلی، آن مقادیر از نرم‌افزار حذف می‌گردند. 

#### 4)	مجوزهای مورد نیاز برای ورود اطلاعات از طریق اکسل
##### مجوز افزودن شماره مشتری:
برای افزودن و ویرایش شماره مشتری کاربر باید مجوز تغییر شماره مشتری را روی نوع هویت مربوطه داشته باشد. در غیر این صورت، اگر این فیلد نگاشت شده باشد، مقدار این فیلد افزوده یا ویرایش نمی‌شود.

##### مجوز افزودن و ویرایش رنگ هویت :
برای افزودن و ویرایش رنگ، کاربر باید مجوز ویرایش رنگ را روی آیتم داشته باشد.
##### مجوز افزودن شماره تماس‌ها:
برای افزودن شماره جدید یا ویرایش شماره‌ها کاربر باید مجوز اضافه کردن شماره تماس را روی نوع هویت مربوطه داشته باشد.
در ویرایش هویت به دلیل اینکه شماره‌های جدید جایگزین شماره‌های قبلی می¬شوند، کاربر علاوه بر این مجوز، باید مجوز حذف شماره تماس هم داشته باشد.
کاربر با مجوز تغییر حالت پیش فرض تماس یا نشانی می‌تواند شماره تماس یا آدرس پیش فرض را از طریق اکسل تعیین کند.
##### مجوز افزودن نشانی :
برای افزودن نشانی جدید یا ویرایش نشانی‌ها کاربر باید مجوز اضافه کردن نشانی داشته باشد.
در ویرایش هویت به دلیل اینکه نشانی‌های جدید جایگزین نشانی های قبلی می‌شوند، کاربر علاوه بر این مجوز، باید مجوز حذف نشانی‌ هم داشته باشد.
##### مجوز افزودن اطلاعات جدید: 
 برای افزودن اطلاعات جدید در مرحله دوم کاربر باید مجوز ذخیره اولیه آیتم را درنوع آیتم انتخاب شده داشته باشد.
##### مجوز ویرایش اطلاعات موجود: 
 برای ویرایش اطلاعات موجود در مرحله دوم کاربر باید مجوز ویرایش آیتم را در نوع آیتم انتخاب شده داشته باشد.
##### مجوز افزودن و ویرایش:
برای افزودن و ویرایش اطلاعات در مرحله دوم کاربر باید مجوز ذخیره اولیه آیتم و ویرایش آیتم را روی نوع آیتم انتخاب شده داشته باشد.

## پیوست شماره 2 (ورود اطلاعات برخی سوابق از طریق اکسل)
ورود اطلاعات آیتم های فرم، قرارداد، پرداخت/دریافت از طریق اکسل، قابلیت جدیدی می‌باشد که در این ورژن قابل استفاده است. 
در این راهنما مراحل ورود اطلاعات، نکات و فرمت صحیح اطلاعات برای ورود از طریق اکسل توضیح داده شده است. ابتدا به بیان توضیحات مشترک در خصوص ورود اطلاعات پرداخته و سپس توضیحات اختصاصی ورود اطلاعات هر موجودیت مطرح شده است.

### 1)	توضیحات مشترک برای ورود اطلاعات موجودیت ها
برای ورود اطلاعات، می‌توانید در لیست آیتم‌های ذکر شده در بالا، با استفاده از کلید ورود اطلاعات از طریق اکسل اقدام نمایید.

#### 1) مرحله اول( بارگذاری فایل)
در گام اول نوع و زیر نوع آیتم انتخاب شده نمایش داده می‌شود. 
اگر لیست آیتم‌ها بر روی نمایش همه(برای مثال همه‌ی فرم‌ها) باشد، در این گام  زیر نوع به صورت خودکار نمایش داده می‌شود که می‌توان آن را ویرایش کرد.
در این مرحله می‌توانید فایل اکسل نمونه‌ای را دانلود کنید، این فایل شامل تمامی فیلدهای نوع آیتم انتخاب شده می‌باشد که با وارد کردن اطلاعات خود در فایل نمونه و ایمپورت آن می‌توانید ورود اطلاعات از طریق اکسل را با فرمت صحیح انجام دهید.

نکته : فیلدهای اضافه از نوع Html، برچسب، تصویر، رنگ، فایل، کمپین، فیلدهای لیستی و فیلد آیتم‌های crm (جز فیلد شرکت/شخص) در فایل نمونه قابل مشاهده نمی‌باشند.
در این مرحله فایل اکسل خود را انتخاب یا از طریق drag & drop آپلود کنید، با کلیک بر روی مرحله بعد وارد مرحله دوم شوید.

#### 2) مرحله دوم( تنظیمات)
انتخاب روش های ورود اطلاعات : 
1)	افزودن اطلاعات جدید: با انتخاب این روش آیتم های موجود در فایل اکسل به نرم‌افزار اضافه می‌شوند.
می‌توانید یکی از فیلدهای موجود در بخش مبنای شناسایی را انتخاب کنید تا براساس آن جستجوی تکراری بودن انجام شود، در صورت تکراری نبودن مقدار مبنای انتخاب شده، آن آیتم به نر‍‌م‌افزار  اضافه می شود.

2)	ویرایش اطلاعات موجود: در این روش براساس فیلدی که به عنوان مبنا انتخاب شده است، جستجوی تکراری بودن انجام می‌شود و در صورت تکراری بودن مقدار مبنای انتخاب شده، آیتم دارای این اطلاعات ویرایش می شود.
با انتخاب چک باکس " فقط فیلد های خالی پر شوند " تنها فیلدهای خالی آیتم در حال ویرایش مقداردهی می‌شوند.

3)	افزودن و ویرایش: در این روش براساس فیلد مبنای انتخاب شده جستجو انجام می‌شود، در صورت تکراری بودن اطلاعات آن فیلد، آیتم دارای این اطلاعات ویرایش می‌شود و در صورت تکراری نبودن، آیتم جدید به نرم‌افزار  اضافه می شود.
با انتخاب چک باکس " فقط فیلد های خالی پر شوند " تنها فیلدهای خالی آیتم در حال ویرایش مقدار دهی می‌شوند.

#### 3) مرحله سوم (نگاشت فیلدها)
در مرحله سوم سرستون‌های فایل اکسل در بخش فیلدهای شما نمایش داده می شود، و فیلدهای موجود در آیتم در بخش فیلدهای ماشین شما نمایش داده می شود.
با drag & drop فیلدها، امکان نگاشت آنها با فیلد های سیستم وجود دارد.
فیلدهای هم نام به صورت خودکار نگاشت می‌شوند و همچنین با انتخاب "نگاشت فیلدهای هم نام" امکان نگاشت وجود دارد.
شما می‌توانید نگاشت مورد نظر خود (به جز نگاشت فیلدهای لیستی) را با استفاده از "ذخیره نگاشت" ذخیره کنید و درصورت نیاز از لیست نگاشت‌ها آن را انتخاب کنید.
در لیست نگاشت های من امکان ویرایش یا حذف  نگاشت ذخیره شده وجود دارد. 
لازم به ذکر است امکان نگاشت "یک" فیلد لیستی در هر بار ورود اطلاعات وجود دارد، برای این کار فیلد لیستی مورد نظر را از لیست انتخاب کرده و نگاشت فیلد را انجام دهید.

نکته: در صورتیکه فیلدی در سیستم دارای مقدار پیش فرض باشد در این بخش قابل مشاهده و ویرایش می‌باشد، همچنین می‌توانید برای فیلدها در این بخش  مقدار پیش‌فرض تعریف کنید تا در صورت خالی بودن این فیلد در فایل اکسل، در نرم‌افزار فیلد با این مقدار پیش‌فرض، مقداردهی شوند.

#### 4) مرحله چهارم (شروع بارگذاری)
در صورت مشکل در بارگذاری اطلاعات، خطای مرتبط در این گام نمایش داده می‌شود و فایل اکسلی شامل آیتم‌های دارای خطا قابل دریافت می‌باشد، که پس از اصلاح خطاها بارگذاری مجدد فایل انجام شود.
در منوی گزارش‌ها، بخش وضعیت عملیات انبوه می‌توان نتایج ورود اطلاعات را مشاهده کرد، همچنین در صورت بروز خطا، می توان از این بخش فایل اکسلی شامل آیتم‌های دارای خطا و علت خطای رخ داده دریافت نمود.

### 1.2)	نکات مشترک برای ورود اطلاعات موجودیت ها

•	امکان ورود اطلاعات فیلدهای از نوع فایل، تصویر، html، کمپین، برچسب، لیست مرتبط، فیلد آیتم‌های سی آر ام(جز فیلد شخص/شرکت)، فیلد اضافه از نوع رنگ، فیلد لیستی از نوع فایل، فیلد لیستی از نوع کاربر/گروه و فیلد لیستی آیتم سی آر ام از طریق اکسل وجود ندارد.

•	در فایل اکسل فیلدهای مبنا باید باهمان نام تعریف شوند، برای نمونه در صورت انتخاب "شماره" ی قرارداد به عنوان مبنا، در اکسل هم باید نام ستون شماره باشد.

•	برای فیلدی که به عنوان مبنا انتخاب شده است و فیلدهای اجباری آن آیتم، می بایست حتما نگاشت انجام شود و در فایل اکسل مقدار دهی هم شده باشند، در غیر این صورت، روند با خطا رو به رو می‌شود.

•	در صورت انتخاب فیلد از نوع شناسه خودکار به عنوان مبنا برای آیتم‌ها، این فیلد صرفا برای شناسایی آیتم‌ها استفاده می‌شود و مقادیر وارد شده برای آن در اکسل در سیستم وارد نمی‌شود.

•	فیلدهایی از نوع لیست کشویی پیش‌فرض (فیلدهای موجود در مدیریت آیتم‌های سیستم) مانند نوع پرداخت یا روش پرداخت باید مطابق مقادیر موجود در نرم‌افزار مقدار دهی شوند، همچنین اگر در این فیلدها دو مقدار همنام وجود داشته باشد، هنگام بارگذاری اطلاعات اگر این مقدار همنام در اکسل تعریف شده باشد، آن فیلد در نرم‌افزار مقداردهی نمی‌شود و خطا می‌دهد.

•	در هنگام ویرایش، اگر براساس مبنای انتخاب شده، چندین آیتم در نرم‌افزار وجود داشته باشد و هیچ فیلد لیستی نگاشت نشده باشد، هیچکدام از آیتم‌ها ویرایش نمی‌شوند.

•	در حالت ویرایش، باید زیر نوع آیتم در حال ویرایش و زیر نوع آیتم انتخاب شده در گام اول یکسان باشد، در غیر این صورت بارگذاری انجام نمی‌شود.

### 1.3)	مجوزهای مشترک برای ورود اطلاعات موجودیت ها
#### مجوز افزودن اطلاعات جدید: 
•	برای افزودن اطلاعات جدید در مرحله دوم کاربر باید مجوز ذخیره اولیه آیتم را درنوع آیتم انتخاب شده داشته باشد.
#### مجوز ویرایش اطلاعات موجود:
•	برای ویرایش اطلاعات موجود در مرحله دوم کاربر باید مجوز ویرایش آیتم را در نوع آیتم انتخاب شده داشته باشد.
#### مجوز افزودن و ویرایش:
•	برای افزودن و ویرایش اطلاعات در مرحله دوم کاربر باید مجوز ذخیره اولیه آیتم و ویرایش آیتم را روی نوع آیتم انتخاب شده داشته باشد.
#### مجوز ویرایش مرتبط با: 
•	کاربر برای ویرایش پروفایل مرتبط با آیتم علاوه بر مجوز ویرایش آیتم باید مجوز ویرایش مرتبط با را برروی نوع آن آیتم داشته باشد.

## 2) ورود اطلاعات فرم‌ها از طریق اکسل
### 2.1) فرمت صحیح ورود اطلاعات فرم‌ها

•	فیلد تاریخ: روز/ماه/سال

•	فیلد چک باکس: true /false، بلی/خیر، yes/no، 0/1

•	فیلد ساعت: 00:00

•	فیلد کاربر:نام کاربری یا کلید کاربر

•	پروفایل مرتبط: نام هویت یا شماره مشتری

•	فیلد لیستی: می بایست به ازای هر مقدار لیست، رکورد مربوطه در فایل اکسل تکرار گردد. همچنین در این حالت، اطلاعات فیلد رکورد آخر به همراه تمام مقادیر فیلد لیستی آن که در رکوردهای مربوطه وارد شده است، در سیستم وارد می¬گردد. مثال فیلد لیستی: لیست عدد، لیست متن

### 2.2) نکات مربوط به ورود اطلاعات فرم‌ها
•	در مرحله دوم می‌توانید یکی از فیلدهای عنوان فرم، فیلد های اضافه‌‎ی (از نوع متن، عدد و شناسه خودکار) روی موجودیت اصلی فرم و زیر نوع موردنظر را به عنوان مبنای شناسایی انتخاب کنید. در صورتیکه فیلد "هیچ کدام" به عنوان مبنا انتخاب شود، تمام فرم های موجود در اکسل به نرم‌افزار اضافه می‌شوند.

•	توجه داشته باشید در صورت اعمال تنظیمات ثبت عنوان خودکار در بخش شخصی سازی برای فرم انتخابی، در ورود فرم های جدید یا ویرایش فرم های موجود از مقادیر فیلد عنوان در فایل اکسل صرف نظر خواهد شد و طبق الگو تنطیم شده برای این نوع فرم، عنوان فرم ها به صورت خودکار برای فرم های جدید درج خواهد شد و در فرم های موجود  این فیلد ویرایش نمی‌شود.همچنین در این صورت در روش افزودن فرم جدید و روش افزودن و ویرایش، عنوان فرم برای انتخاب مبنا نمایش داده نمی‌شود.

### 3)ورود اطلاعات قراردادها از طریق اکسل
#### 3.1) فرمت صحیح ورود اطلاعات قراردادها

•	فیلد تاریخ: روز/ماه/سال

•	فیلد چک باکس: true /false، بلی/خیر، yes/no، 0/1

•	فیلد کاربر:نام کاربری یا کلید کاربر

•	فیلد ساعت: 00:00

•	شماره قرارداد: براساس قالب شماره گذاری آن نوع موجودیت 

•	پروفایل مرتبط: نام هویت یا شماره مشتری

•	فیلد لیستی: می بایست به ازای هر مقدار لیست، رکورد مربوطه در فایل اکسل تکرار گردد. همچنین در این حالت، اطلاعات فیلد رکورد آخر به همراه تمام مقادیر فیلد لیستی آن که در رکوردهای مربوطه وارد شده است، در سیستم وارد می گردد. مثال فیلد لیستی: لیست عدد، لیست متن

#### 3.2)نکات مربوط به ورود اطلاعات قراردادها
•	در مرحله‌ی دوم می‌توانید یکی از فیلدهای عنوان قرارداد، شماره قرارداد، فیلدهای اضافه‌‎ی (از نوع متن، عدد و شناسه خودکار) روی موجودیت اصلی قرارداد و زیر نوع موردنظر را به عنوان مبنای شناسایی انتخاب کنید.

### 4) ورود اطلاعات دریافت/پرداخت از طریق اکسل
#### 4.1) فرمت صحیح ورود اطلاعات دریافت/پرداخت

•	فیلد تاریخ: روز/ماه/سال

•	فیلد چک باکس: true /false، بلی/خیر، yes/no، 0/1

•	فیلد ساعت: 00:00

•	فیلد کاربر:نام کاربری یا کلید کاربر

•	شماره دریافت/پرداخت: براساس قالب شماره گذاری آن نوع موجودیت 

•	پروفایل مرتبط: نام هویت یا شماره مشتری

•	فیلد لیستی: می بایست به ازای هر مقدار لیست، رکورد مربوطه در فایل اکسل تکرار گردد. همچنین در این حالت، اطلاعات فیلد رکورد آخر به همراه تمام مقادیر فیلد لیستی آن که در رکوردهای مربوطه وارد شده است، در سیستم وارد می گردد. مثال فیلد لیستی: لیست عدد، لیست متن

#### 4.2) نکات مربوط به ورود اطلاعات دریافت/پرداخت

•	در مرحله‌ی دوم می توانید یکی از فیلدهای شماره دریافت/پرداخت، فیلد های اضافه‌ی‌‎(از نوع متن، عدد و شناسه خودکار) روی موجودیت اصلی دریافت/پرداخت و زیر نوع موردنظر را به عنوان مبنای شناسایی انتخاب کنید.

•	امکان ورود اطلاعات فیلد فاکتور مرتبط از طریق اکسل وجود ندارد.

#### 4.3) مجوزهای مربوط به ورود اطلاعات دریافت/پرداخت
### مجوز تعیین نوع دریافت/پرداخت: 

کاربر باید برای انتخاب نوع دریافت/پرداخت نقدی مجوز تعیین نوع دریافت/پرداخت نقدی، برای دریافت/پرداخت اعتباری مجوز تعیین نوع دریافت/پرداخت اعتباری و برای دریافت/پرداخت چکی مجوز تعیین نوع دریافت/پرداخت چکی را داشته باشد.

## پیوست شماره 3 (ورود اطلاعات لیست قیمت‌ها از طریق اکسل)
### ورود اطلاعات لیست قیمت‌ها از طریق اکسل
با قابلیت جدید ورود اطلاعات از طریق اکسل، می‌توانید لیست قیمت‌ها را در نرم‌افزار وارد کنید.
#### 1) فرمت ورود اطلاعات لیست قیمت‌ها

•	ستون اول: کد محصولات 

•	ستون دوم: سیاست قیمت گذاری(درصد و رقم)

-در حالت درصد:
گذاشتن علامت درصد در سلول مربوطه
 تعداد رقم اعشار مجاز درصد: 2 رقم 

-در حالت رقم: 
تعداد رقم اعشار مجاز رقم: با توجه به تعداد تعیین شده در قسمت "تنظیمات ارز"

برای ورود اطلاعات می‌توانید در مدیریت لیست قیمت‌ها با استفاده از کلید ورود اطلاعات از اکسل اقدام کنید.

#### 2) مراحل ورود اطلاعات
##### 2.1)	مرحله اول ( بارگذاری فایل)
در این مرحله می‌توانید فایل اکسل نمونه‌ای را برای ورود اطلاعات خود دانلود کنید.
در این مرحله فایل اکسل خود را انتخاب یا از طریق drag & drop آپلود کنید، با کلیک بر روی مرحله بعد وارد مرحله دوم شوید.

##### 2.2)	گام دوم (تنظیمات)
انتخاب روش های ورود اطلاعات :  
1.	افزودن اطلاعات جدید: با انتخاب این روش لیست قیمت‌های جدید در فایل اکسل به نرم‌افزار اضافه می‌شوند.
می‌توانید مبنای شناسایی را نام لیست قیمت انتخاب کنید تا براساس آن جستجو انجام شود، در صورت تکراری نبودن نام لیست قیمت، آن لیست قیمت به نرم‌افزار اضافه می‌شود.
2.	ویرایش اطلاعات موجود: در این روش، براساس نام لیست قیمت جستجوی تکراری بودن انجام می‌شود و در صورت تکراری بودن، لیست قیمت‌ دارای این نام ویرایش می شود.

###### انتخاب نحوه ویرایش:

•	افزودن محصولات جدید به لیست قیمت موجود: در این روش تنها محصولاتی که در لیست قیمت موجود در نرم افزار، وجود ندارند را به لیست قیمت اضافه می‌کند.

•	بروز رسانی مقادیر محصولات موجود: با استفاده از این حالت تنها مقادیر رقم یا درصد تعریف شده برای محصولات موجود در لیست قیمت ویرایش می‌شوند.

•	حذف محصولات موجود در لیست قیمت با وارد کردن کاراکتر DL در سلول مقدار آن: با انتخاب این حالت و استفاده از کاراکتر DL در سلول مقدار برای محصول، آن محصول از لیست قیمت حذف می‌شود. 

3.	افزودن و ویرایش: در این روش با استفاده از نام لیست قیمت، جستجوی تکراری بودن انجام می¬شود. در صورت تکراری بودن نام لیست قیمت در نرم‌افزار، آن لیست ویرایش می‌شود و در غیر این صورت لیست قیمت جدید به نرم‌افزار اضافه می‌شود. 
نحوه‌ی ویرایش را با توجه به توضیحات مرحله دوم می‌توانید انتخاب کنید.

##### 2.3)	مرحله‌ سوم (نگاشت فیلدها)
در این مرحله سرستون‌های فایل اکسل که نام لیست قیمت‌ها می‌باشد در بخش فیلدهای شما نمایش داده می شود و در بخش فیلدهای ماشین شما نوع فاکتورهایی که می‌خواهید این لیست قیمت‌ها برای آن ها تعریف شود نمایش داده می‌شود.
در هر بار ورود اطلاعات تنها یک لیست قیمت را می‌توانید به هر کدام از نوع فاکتورها اختصاص دهید.

##### 2.4)	مرحله چهارم (شروع بارگذاری)
در صورت مشکل در بارگذاری اطلاعات، خطای مرتبط در این گام نمایش داده می‌شود و فایل اکسلی شامل لیست قیمت‌های دارای خطا قابل دریافت می‌باشد، که پس از اصلاح خطاها بارگذاری مجدد فایل انجام شود.
در منوی گزارش‌ها، بخش وضعیت عملیات انبوه می‌توان نتایج ورود اطلاعات را مشاهده کرد، همچنین در صورت بروز خطا فایل اکسلی شامل آیتم‌های دارای خطا و علت خطای رخ داده قابل دریافت می‌باشد.

#### 3. نکات مربوط به ورود اطلاعات لیست قیمت‌ها

•	در فایل اکسل در هر ستون لیست قیمت¬، سیاست قیمت گذاری همانند شکل زیر، هم می تواند به صورت درصد و هم به صورت مقدار باشد. 

 ![EXCEL11](https://user-images.githubusercontent.com/85984198/125406555-3496d380-e3ce-11eb-8acd-12b0c53ee873.jpg)

•	اگر میخواهید محصول تعریف شده در اکسل در برخی از لیست قیمت‌ها تعریف نشود یا در هنگام ویرایش لیست قیمت، ویرایش نشود و مقدار پیشین خود را داشته باشد، باید سلول مقدار آن  در لیست قیمت مورد نظر خالی باشد.

•	در هر فایل اکسل حداکثر می توان 4 لیست قیمت به ازای هر "نوع فاکتور" که در تنظیمات لیست قیمت موجود است، وارد نمود.

•	برای ویرایش لیست قیمت باید نام لیست قیمت تعریف شده در اکسل با نام لیست قیمت موجود کاملا یکسان باشد.

#### 4.مجوز مورد نیاز برای ورود اطلاعات لیست قیمت‌ها
•	برای ورود اطلاعات لیست قیمت‌ها از طریق اکسل کاربر باید مجوز مدیریت محصولات را داشته باشد.

